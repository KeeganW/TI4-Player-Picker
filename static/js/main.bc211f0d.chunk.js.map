{"version":3,"sources":["helpers/BootstrapScripts.js","panels/icons/influence.png","panels/icons/planet.png","panels/icons/resource.png","panels/icons/specialty-biotic.png","panels/icons/specialty-warfare.png","panels/icons/specialty-propulsion.png","panels/icons/specialty-cybernetic.png","panels/icons/trait-cultural.png","panels/icons/trait-hazardous.png","panels/icons/trait-industrial.png","panels/MoreInfo.js","panels/ExtraTiles.js","overview/MainOverview.js","map/MainMap.js","map/ShareMapModal.js","map/LoadMapModal.js","map/MapControls.js","options/OptionsControls.js","options/HelpModal.js","options/SetPlayerNameModal.js","options/SetRacesModal.js","options/MapOptions.js","App.js","helpers/Helpers.js","reportWebVitals.js","index.js"],"names":["BootstrapScripts","id","src","integrity","crossOrigin","React","Component","MoreInfo","props","getAdjacent","bind","tileNumber","originalAdjacencies","adjacencyData","adjacencies","planets","resources","influence","specialties","traits","length","adjacentTileNumber","splice","adjacentTile","this","tiles","tileData","hyperlanes","indexOf","getTileNumber","hyperlaneAdjacencies","tilePositionRelatedToHyperlane","Number","hyperlaneLinks","all","currentRotation","split","hyperlane","hyperlaneStart","hyperlaneEnd","hyperlaneStartTilenumber","hyperlaneEndTilenumber","push","planetIndex","planet","moreInfoByPlayer","adjacentInfo","playerName","currentPlayerNames","scope","className","Array","cultural","map","e","i","traitCultural","alt","hazardous","traitHazardous","industrial","traitIndustrial","biotic","specialtyBiotic","warfare","specialtyWarfare","propulsion","specialtyPropulsion","cybernetic","specialtyCybernetic","visible","resource","ExtraTiles","underlayStyle","width","height","position","top","left","tileStyle","display","margin","overlayStyle","marginLeft","systemNumbers","parseSystemNumber","systemNumber","match","concat","blue","red","useProphecyOfKings","showAllExtraTiles","customMapBuilding","pokBlue","pokRed","sort","a","b","numberA","stringA","numberB","stringB","tileObjects","isNaN","undefined","overlayVisible","style","window","location","origin","pathname","draggable","onDragStart","drag","onDrop","drop","onDragOver","allowDrop","onDragEnter","dragEnter","onDragLeave","dragLeave","xmlns","viewBox","fill","points","type","name","checked","onChange","toggleShowAllExtraTiles","htmlFor","toggleCustomMapBuilding","onClick","unsetAllTiles","MainOverview","transform","href","MainMap","toggleControls","getRotationDegrees","prevProps","prevState","snapshot","ReactTooltip","rebuild","event","splitArray","target","targetName","newTileClicked","tileClicked","updateTileClicked","rotationDirection","tile","$","degrees","rotationAngle","newTiles","updateTiles","css","unusedTiles","randomUnusedTile","Math","floor","random","lockedIndex","lockedTiles","newLockedTiles","updateLockedTiles","excludedIndex","excludedTiles","newExcludedTiles","newIncludedTiles","includedTiles","includedIndex","updateInExcludedTiles","obj","matrix","angle","values","round","atan2","PI","mapTiles","hidden","boardData","pokSize","onTouchMove","touchMove","onTouchEnd","touchEnd","ShareMapModal","getTTSTileString","copyTileStringToClipboard","copyLinkToClipboard","removeTrailing","sleep","downloadImage","tileString","shift","toString","replaceAll","console","log","navigator","clipboard","writeText","pop","ms","Promise","resolve","setTimeout","addClass","scrollTo","exportComponentAsPNG","fileName","html2CanvasOptions","backgroundColor","scrollX","scrollY","pageYOffset","scale","removeClass","Modal","show","onHide","hideModal","Header","closeButton","Title","Body","value","readOnly","LoadMapModal","state","currentInputTiles","updateInputTiles","loadTiles","inputTiles","unshift","index","newValue","aIndex","bIndex","sideLocation","rotation","substring","setState","preventDefault","parseTTSTileString","onSubmit","placeholder","MapControls","shareMapHelp","loadMapHelp","toggleShareMapHelp","toggleLoadMapHelp","zoomPlus","zoomMinus","toggleOverlay","toggleExtraTiles","extraTilesVisible","toggleMoreInfo","moreInfoVisible","toggleBackground","OptionsControls","isMobileView","toggleOptions","HelpModal","title","dangerouslySetInnerHTML","__html","content","SetPlayerNameModal","x","defaultValue","handleNameChange","SetRacesModal","searchString","updateSearchString","visibleRaces","races","pokRaces","handleRacesChange","raceName","raceIndex","raceVisible","toLowerCase","includes","replace","currentRaces","MapOptions","startingValues","numberOfPlayers","pokNumberOfPlayers","boardStyles","Object","keys","styles","key","filter","boardStylesPok","pickStyles","placementStyles","raceData","homeworlds","pokHomeworlds","optionsPossible","currentNumberOfPlayers","currentNumberOfPlayersOptions","currentBoardStyleOptions","currentBoardStyle","currentPickStyle","currentPlacementStyle","currentSeed","userSetSeed","pickRaces","pickMultipleRaces","shuffleBoards","reversePlacementOrder","ensureRacialAnomalies","generated","pickRacesHelp","boardStyleHelp","pickStyleHelp","placementStyleHelp","setPlayerNamesHelp","setRacesHelp","pickMultipleRacesHelp","shufflePriorityHelp","reversePlacementOrderHelp","ensureRacialAnomaliesHelp","resourceWeight","influenceWeight","planetCountWeight","specialtyWeight","anomalyWeight","wormholeWeight","shuffleThreshold","handleInputChange","updatePok","updatePlayerCount","updateBoardStyle","updateSeed","ensureAnomalies","ensureWormholesForType","updateBoardStyleOptions","encodeSettings","decodeSettings","generateBoard","getNewTileSet","togglePickRacesHelp","toggleBoardStyleHelp","togglePickStyleHelp","togglePlacementStyleHelp","toggleSetPlayerNamesHelp","toggleSetRacesHelp","togglePickMultipleRacesHelp","toggleShufflePriorityHelp","toggleReversePlacementOrderHelp","toggleEnsureRacialAnomaliesHelp","nameIndex","parseInt","newPlayerNames","race","newCurrentRaces","indexToToggle","updateRaces","boardOptions","toggleProphecyOfKings","newSeed","str","charAt","toUpperCase","slice","array","t","m","seed","valueOf","sin","encodedSettings","padStart","combinedRaces","changedPlayerName","playerNames","newSettings","currentIndex","updatePlayerNames","systemIndexes","getNewTilesToPlace","shuffle","newSystems","getNewSystemsToPlace","blankMap","placeHyperlanes","placeHomeSystems","placeLockedSystems","checkAdjacencies","primary","secondary","tertiary","home","newPrimary","homeSystem","adjacentSystems","adjacentSystem","numberOfSystems","allBlues","allReds","system","blueTileRatio","redTileRatio","redsToPlace","bluesToPlace","ensuredAnomalies","forEach","anomalies","asteroidFields","pokAsteroidFields","supernovas","pokSupernovas","nebulae","pokNebulae","gravityRifts","pokGravityRifts","some","find","allAlphaWormholes","alphaWormholes","pokAlphaWormholes","allBetaWormholes","betaWormholes","pokBetaWormholes","weights","getWeightedPlanetList","hyperlaneData","raceToHomeSystemMap","currentLocation","newTilesLocation","allTrueAnomalies","anomaly","pokAnomaly","anomalyTileNumber","adjacentTiles","adjacentAnomalies","swapped","blankReds","blankRed","pokBlankRed","possibleBlanks","blankRedTileNumber","swappable","alphaWormhole","alphaWormholeTileNumber","adjacentTileNumbers","adjacentWormhole","el","adjacentTilesNumbers","betaWormhole","betaWormholeTileNumber","possibleTiles","planetWormholes","allWormholes","oppositeWormholes","allAnomalyList","unusedWormholes","usedWormholes","wormholeIndex","wormholesToUse","unusedWormhole","reverseReplace","numPlanetsToPlace","numAnomaliesLeftToBePlaced","possibleAnomalies","anomalyIndex","numTilesToReplace","replacementTiles","reverseBeforeAndAfter","reverse","currentTileIndex","tileOfInterest","possiblePlanets","planetWeights","planetTileNumber","getWeight","currentHighValue","currentSetToShuffle","postPossiblePlanets","planetWeight","orderedPlanets","weightedPlanet","total_weight","capitalize","App","isOptionsMenuShowing","overviewVisible","backgroundAnimated","zoom","lastCall","mobileBreakpoint","encodedOptions","currentMobileHover","mapOptions","createRef","drawMap","onPopState","checkResize","validateTiles","toggleOptionsMenu","updateTileNumberOverlays","showExtraTiles","zoomScroll","zoomPlusClick","zoomMinusClick","handleDrop","handleTouchMove","handleTouchEnd","$mapContainer","$tiMap","onpopstate","onresize","document","addEventListener","removeEventListener","innerWidth","documentElement","setProperty","url","URL","settings","searchParams","get","current","newEncodedOptions","isNewGeneration","skipTrailing","params","history","pushState","newOptionsMenuState","optionsSize","showTiles","numOverlay","hide","justTriggeredTiles","justTriggeredInfo","systemSelector","overlaySelector","Date","now","ctrlKey","deltaY","numberOnly","withDash","result","exec","mapVisible","mapControlsVisible","mapNumberTilesHeight","mapNumberTilesWidth","mapWidth","mapHeight","tileWidth","tileHeight","constraintWidth","min","constraintHeight","offsets","leftWidth","topHeight","halfWidth","ceil","halfHeight","treQuarWidth","calculateOffsets","currentPlayerNumber","tileWrapper","underlay","html","scrollIntoView","behavior","block","inline","ev","targetSelector","targetUnderlay","dataTransfer","setData","fromId","getData","targetId","fromSelector","targetType","fromType","targetSecond","fromSecond","tilesCopy","swapSources","temp","attr","targetSource","from","item","changedTouch","changedTouches","elem","elementFromPoint","clientX","clientY","stopPropagation","ref","effect","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.bc211f0d.chunk.js","sourcesContent":["import React from \"react\";\n\n/**\n * Scripts for bootstrap and jquery integration.\n */\nclass BootstrapScripts extends React.Component {\n    render() {\n        return (\n            <div id=\"bootstrapScripts\">\n                <script src=\"https://code.jquery.com/jquery-3.3.1.min.js\"\n                         integrity=\"sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=\"\n                         crossOrigin=\"anonymous\" />\n                <script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js\"\n                        integrity=\"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1\"\n                        crossOrigin=\"anonymous\" />\n                <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js\"\n                        integrity=\"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM\"\n                        crossOrigin=\"anonymous\" />\n            </div>\n        );\n    }\n}\nexport default BootstrapScripts;","export default __webpack_public_path__ + \"static/media/influence.d1f8e76f.png\";","export default __webpack_public_path__ + \"static/media/planet.7203e647.png\";","export default __webpack_public_path__ + \"static/media/resource.4e66e6d4.png\";","export default __webpack_public_path__ + \"static/media/specialty-biotic.683b8aa5.png\";","export default __webpack_public_path__ + \"static/media/specialty-warfare.222674a3.png\";","export default __webpack_public_path__ + \"static/media/specialty-propulsion.767d15a0.png\";","export default __webpack_public_path__ + \"static/media/specialty-cybernetic.16601911.png\";","export default __webpack_public_path__ + \"static/media/trait-cultural.800b2f56.png\";","export default __webpack_public_path__ + \"static/media/trait-hazardous.64956721.png\";","export default __webpack_public_path__ + \"static/media/trait-industrial.37a31434.png\";","import React from \"react\";\nimport adjacencyData from \"../data/adjacencyData.json\";\nimport tileData from \"../data/tileData.json\";\n\nimport influence from './icons/influence.png';\nimport planet from './icons/planet.png';\nimport resource from './icons/resource.png';\nimport specialtyBiotic from './icons/specialty-biotic.png';\nimport specialtyWarfare from './icons/specialty-warfare.png';\nimport specialtyPropulsion from './icons/specialty-propulsion.png';\nimport specialtyCybernetic from './icons/specialty-cybernetic.png';\nimport traitCultural from './icons/trait-cultural.png';\nimport traitHazardous from './icons/trait-hazardous.png';\nimport traitIndustrial from './icons/trait-industrial.png';\n\nclass MoreInfo extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.getAdjacent = this.getAdjacent.bind(this);\n    }\n\n    getAdjacent(tileNumber) {\n        // TODO rewrite this to calculate adjacencies, not reference them from a data file\n        let originalAdjacencies = [...adjacencyData[tileNumber]];\n        let adjacencies = [...adjacencyData[tileNumber]];\n        // adjacencies.push(tileNumber);  // Add back in if we want to add the home system to these calcs\n\n        let planets = 0;\n        let resources = 0;\n        let influence = 0;\n        let specialties = {\n            \"biotic\": 0,\n            \"warfare\": 0,\n            \"propulsion\": 0,\n            \"cybernetic\": 0\n        };\n        let traits = {\n            \"cultural\": 0,\n            \"industrial\": 0,\n            \"hazardous\": 0\n        }\n\n        while (adjacencies.length > 0) {\n            let adjacentTileNumber = adjacencies.splice(0, 1)[0]\n            let adjacentTile = this.props.tiles[adjacentTileNumber]\n            if (tileData.hyperlanes.indexOf(this.props.getTileNumber(adjacentTile)) >= 0) {\n                // This is a hyperlane, so add the tiles that are linked\n                let hyperlaneAdjacencies = [...adjacencyData[adjacentTileNumber]];\n                let tilePositionRelatedToHyperlane = hyperlaneAdjacencies.indexOf(Number(tileNumber)); // In the future this code can be adapted, with this tile number being the source tile\n                let hyperlaneLinks = tileData.all[this.props.getTileNumber(adjacentTile)][\"hyperlanes\"];\n                let currentRotation = Number(adjacentTile.split(\"-\")[1])\n\n                for (let hyperlane of hyperlaneLinks) {\n                    let hyperlaneStart = (hyperlane[0] + currentRotation) % 6;\n                    let hyperlaneEnd = (hyperlane[1] + currentRotation) % 6;\n                    let hyperlaneStartTilenumber = hyperlaneAdjacencies[hyperlaneStart]\n                    let hyperlaneEndTilenumber = hyperlaneAdjacencies[hyperlaneEnd]\n\n                    if (hyperlaneStart === tilePositionRelatedToHyperlane && originalAdjacencies.indexOf(hyperlaneEndTilenumber) < 0) {\n                        // Add the tile on the other end of this hyperlane to be added to the total\n                        adjacencies.push(hyperlaneEndTilenumber)\n                    } else if (hyperlaneEnd === tilePositionRelatedToHyperlane && originalAdjacencies.indexOf(hyperlaneStartTilenumber) < 0) {\n                        // Add the tile on the other end of this hyperlane to be added to the total\n                        adjacencies.push(hyperlaneStartTilenumber)\n                    }\n                }\n            }\n            if (adjacentTile > 0) {\n                for (let planetIndex in tileData.all[adjacentTile][\"planets\"]) {\n                    let planet = tileData.all[adjacentTile][\"planets\"][planetIndex];\n                    planets += 1;\n                    resources += planet[\"resources\"];\n                    influence += planet[\"influence\"];\n                    specialties[planet[\"specialty\"]] += 1;\n                    traits[planet[\"trait\"]] += 1;\n                }\n            }\n        }\n        return {\n            \"planets\": planets,\n            \"resources\": resources,\n            \"influence\": influence,\n            \"specialties\": specialties,\n            \"traits\": traits,\n        }\n    }\n\n    render() {\n        let moreInfoByPlayer = [];\n\n        for (let tileNumber in this.props.tiles) {\n            if ((this.props.tiles[tileNumber] >= 0 && this.props.tiles[tileNumber] < 18) ||\n                (this.props.tiles[tileNumber] >= 51 && this.props.tiles[tileNumber] < 59)) {\n                // This is a homeworld, so gather its info\n                let adjacentInfo = this.getAdjacent(tileNumber);\n                let playerName = this.props.currentPlayerNames[moreInfoByPlayer.length];\n                if (playerName === \"\") {\n                    playerName = \"P\" + (moreInfoByPlayer.length + 1);\n                }\n                moreInfoByPlayer.push(\n                    <tr key={\"more-info-\" + playerName} >\n                        <th scope=\"row\">{playerName}</th>\n                        <td>{adjacentInfo.resources}</td>\n                        <td>{adjacentInfo.influence}</td>\n                        <td>\n                            <span className={\"d-flex\"}>\n                                {[...Array(adjacentInfo.traits.cultural)].map((e, i) => <img key={playerName + \"-cultural-\" + i} className={\"icon\"} src={traitCultural} alt={\"C\"}/>)}\n                                {[...Array(adjacentInfo.traits.hazardous)].map((e, i) => <img key={playerName + \"-hazardous-\" + i} className={\"icon\"} src={traitHazardous} alt={\"H\"}/>)}\n                                {[...Array(adjacentInfo.traits.industrial)].map((e, i) => <img key={playerName + \"-industrial-\" + i} className={\"icon\"} src={traitIndustrial} alt={\"I\"}/>)}\n                            </span>\n                        </td>\n                        <td>\n                            <span className={\"d-flex\"}>\n                                {[...Array(adjacentInfo.specialties.biotic)].map((e, i) => <img key={playerName + \"-biotic-\" + i} className={\"icon\"} src={specialtyBiotic} alt={\"B\"}/>)}\n                                {[...Array(adjacentInfo.specialties.warfare)].map((e, i) => <img key={playerName + \"-warfare-\" + i} className={\"icon\"} src={specialtyWarfare} alt={\"W\"}/>)}\n                                {[...Array(adjacentInfo.specialties.propulsion)].map((e, i) => <img key={playerName + \"-propulsion-\" + i} className={\"icon\"} src={specialtyPropulsion} alt={\"P\"}/>)}\n                                {[...Array(adjacentInfo.specialties.cybernetic)].map((e, i) => <img key={playerName + \"-cybernetic-\" + i} className={\"icon\"} src={specialtyCybernetic} alt={\"C\"}/>)}\n                            </span>\n                        </td>\n                    </tr>\n                );\n            }\n\n        }\n        return (\n            <div id=\"moreInfoContainer\" className={this.props.visible ? \"\" : \"d-none\"}>\n                <div className=\"title\">\n                    <h4 id=\"infoTitle\" className=\"text-center\">Assets Adjacent to Home System</h4>\n                </div>\n                <div id=\"moreInfo\" className=\"\">\n                    <table className=\"table\">\n                        <thead>\n                            <tr>\n                                <th scope=\"col\"></th>\n                                <th scope=\"col\"><img className={\"icon\"} src={resource} alt={\"Res.\"}/></th>\n                                <th scope=\"col\"><img className={\"icon\"} src={influence} alt={\"Inf.\"}/></th>\n                                <th scope=\"col\"><img className={\"icon\"} src={planet} alt={\"Planets\"}/></th>\n                                <th scope=\"col\"><img className={\"icon\"} src={specialtyWarfare} alt={\"Tech\"}/></th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {moreInfoByPlayer}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        );\n    }\n}\nexport default MoreInfo;\n","import React from \"react\";\nimport tileData from \"../data/tileData.json\";\n\nclass ExtraTiles extends React.Component {\n    constructor(props) {\n        super(props);\n        this.underlayStyle = {\n            width: \"210px\",\n            height: \"185px\",\n            position: \"absolute\",\n            top: \"0\",\n            left: \"0\",\n        }\n        this.tileStyle = {\n            width: \"200px\",\n            height: \"175px\",\n            display: \"none\",\n            margin: \"5px\",\n            position: \"relative\",\n        }\n        this.overlayStyle = {\n            height: \"175px\",\n            marginLeft: \"92px\",\n            top: \"85px\",\n            display: \"none\",\n        }\n    }\n    \n    render() {\n        let systemNumbers = [];\n        systemNumbers = systemNumbers.concat(tileData.blue).concat(tileData.red);\n        if (this.props.useProphecyOfKings || this.props.showAllExtraTiles || this.props.customMapBuilding) {\n            systemNumbers = systemNumbers.concat(tileData.pokBlue).concat(tileData.pokRed);\n        }\n        if (this.props.customMapBuilding) {\n            systemNumbers = [-1].concat(systemNumbers.concat(tileData.hyperlanes));\n        }\n\n        function parseSystemNumber(systemNumber) {\n            if (typeof systemNumber == \"number\") {\n                return [systemNumber, \"\"];\n            } else {\n                const [, numberPart, stringPart] = systemNumber.match(/(\\d+)(.*)/);\n                return [numberPart, stringPart];\n            }\n        }\n\n        function compareSystemNumbers(a, b) {\n            const [numberA, stringA] = parseSystemNumber(a);\n            const [numberB, stringB] = parseSystemNumber(b);\n            if (numberA === numberB) {\n                if (stringA < stringB) {\n                    return -1;\n                }\n                if (stringA === stringB) {\n                    return 0;\n                }\n                return 1;\n            }\n            return numberA - numberB;\n        }\n\n        systemNumbers.sort(compareSystemNumbers);\n\n        const tileObjects = []\n        for (let systemNumber of systemNumbers) {\n\n            // Handle hyperlanes differently. Pull out their tile number, separate from their rotation angle\n            if (isNaN(Number(systemNumber)) && systemNumber !== undefined) {\n                systemNumber = systemNumber.split(\"-\")[0]\n            }\n\n            tileObjects.push(\n                <div key={\"extra-tile-wrapper-\" + systemNumber} className=\"tile-wrapper\">\n                    <span id={\"extra-number-\" + systemNumber} className={\"overlay\" + (this.props.overlayVisible ? \"\" : \" d-none\")} style={this.overlayStyle}>{systemNumber === -1 ? \"Empty\" : systemNumber}</span>\n                    <img id={\"extra-\" + systemNumber}\n                         width=\"200px\"\n                         height=\"175px\"\n                         className=\"tile\"\n                         src={window.location.origin + window.location.pathname + \"/tiles/ST_\" + systemNumber + \".png\"}\n                         draggable=\"true\" onDragStart={this.props.drag} onDrop={this.props.drop}\n                         onDragOver={this.props.allowDrop} onDragEnter={this.props.dragEnter}\n                         onDragLeave={this.props.dragLeave}\n                         alt=\"\"\n                         style={this.tileStyle}\n                    />\n                    <svg id={\"extra-underlay-\" + systemNumber} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"underlay\" fill=\"currentColor\"\n                         style={this.underlayStyle}>\n                        <polygon points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\n                    </svg>\n                </div>\n            )\n        }\n    \n        return (\n            <div id=\"extraTilesContainer\" className={this.props.visible ? \"\" : \"d-none\"}>\n                <div className=\"title\">\n                    <h4 id=\"extraTitle\" className=\"text-center\">Extra Tiles</h4>\n                </div>\n\n                <div className=\"custom-control custom-checkbox mt-3 ml-3 mr-3 text-center\">\n                    <input type=\"checkbox\" className=\"custom-control-input\" id=\"showAllExtraTiles\" name=\"showAllExtraTiles\" checked={this.props.showAllExtraTiles} onChange={this.props.toggleShowAllExtraTiles} />\n                    <label className=\"custom-control-label\" htmlFor=\"showAllExtraTiles\">Show All Tiles</label>\n                </div>\n\n                <div className=\"custom-control custom-checkbox mt-3 ml-3 mr-3 text-center\">\n                    <input type=\"checkbox\" className=\"custom-control-input\" id=\"customMapBuilding\" name=\"customMapBuilding\" checked={this.props.customMapBuilding} onChange={this.props.toggleCustomMapBuilding} />\n                    <label className=\"custom-control-label\" htmlFor=\"customMapBuilding\">Custom Map Building</label>\n                </div>\n                <div className={\"mt-3 ml-3 mr-3 text-center \" + (this.props.customMapBuilding ? \"\" : \"d-none\")}>\n                    <button className=\"btn btn-primary\" id=\"unsetAllTilesButton\" onClick={this.props.unsetAllTiles} >\n                        Unset All Tiles\n                    </button>\n                </div>\n\n                <div id=\"extraTiles\" className=\"\">\n                    {tileObjects}\n                </div>\n            </div>\n        );\n    }\n}\nexport default ExtraTiles;","import React from \"react\";\nimport {ArrowRepeat, Check, Share, Lock, X} from \"react-bootstrap-icons\";\n\nclass MainOverview extends React.Component {\n    render() {\n        return (\n            <div id=\"overview\" className={\"flex-column justify-content-center\" + (this.props.visible ? \" d-flex\" : \" d-none\")}>\n                <div className=\"title\">\n                    <h1>TI4 Map Generator</h1>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>Customize Your Next Twilight Imperium 4 Map!</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            Use this tool to generate a fresh new Twilight Imperium map for the next game you play. The\n                            goal of this tool is to cut down the game setup time by letting you generate a fair and balanced map\n                            before you play, so that you are not spending a half-hour picking and placing tiles, or getting a bad draw of tiles. Get started\n                            by customizing settings via the generation panel on the right, and hit \"Generate\" to see a new\n                            map.\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>Individual Tile Controls</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            Modify individual tiles by clicking on them to pull up the tile control menu. Lock the tile in place\n                            with the (\n                            <Lock className=\"icon d-inline\" />\n                            ) button. Include it in all future generations with the (\n                            <Check className=\"icon d-inline\" />\n                            ) button. Exclude it from all future generations with the (\n                            <X className=\"icon d-inline\" />\n                            ) button. Finally, swap it with a tile not on the board with the (\n                            <ArrowRepeat className=\"icon d-inline\" />\n                            ) button. Controls reset on page refresh.\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>Drag and Drop for Further Customization</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            Unhappy with a wormhole next to a home world? Are two asteroids next to one another? Don't like\n                            a certain system? Just swap it with another tile by clicking and dragging one tile over the top of\n                            another tile. Alternatively, use the tile controls (click on a tile once to see them) and click\n                            the bottom middle \"Swap with an extra tile\" button (\n                            <ArrowRepeat className=\"icon d-inline\" />\n                            ) to swap with a tile not on the board.\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>New Prophecy of Kings Expansion Content</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            The new expansion content for TI4, called Prophecy of Kings, was recently released. Check out\n                            the new tiles as well as the 7 and 8 player maps. Hyperlanes which connect systems together\n                            were also added, and are included on some non expansion board styles.\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>Share With Your Friends</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            After you have made your custom map, click on the \"Share This Map\" button (\n                            <Share className=\"icon d-inline\" />\n                            ) to find out how to send it to your friends! You can share the url as a link, copy the\n                            Table Top Simulator string to use in the TI4 mod, or simply download an image of the map\n                            to post. If you toggle the tile overlay on, you can have the tile numbers appear in your\n                            downloaded image.\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>Use Any Tile You Want</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            Do you really like the gravity rift anomaly and not see it on the board? Click the \"Show unused\n                            tiles\" button (\n                            <svg id=\"showExtraTilesSvg\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"icon d-inline\" fill=\"currentColor\">\n                                <polygon id=\"showExtraTilesPoly\" points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\n                            </svg>\n                            ) to see any tiles not currently being used in the map, and drag and drop them to add them!\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>Easy Setup On Game Day</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            It can be hard to know which tile is which when it is time to setup your new board. Click the\n                            \"Toggle Tile Number Overlay\" button (\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 194.78 169.62\" className=\"icon d-inline\" fill=\"currentColor\">\n                                <polygon className=\"overlay-cls-1\" points=\"148.03 4 51.81 4 4.61 86.92 52.02 169.84 148.03 169.84 195.03 86.92 148.03 4\"/>\n                                <text className=\"overlay-cls-2\" transform=\"translate(27.09 132.03)\">18</text>\n                            </svg>\n                            )\n                             to see the numbers of every tile on your custom board.\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    <h4 className={\"m-3\"}>Have Any Ideas On Improvements?</h4>\n                    <div className={\"d-flex\"}>\n                        <p className={\"text-left p-3\"}>\n                            I am always open to feedback and suggestions! You can see\n                            the <a href=\"https://github.com/KeeganW/ti4/issues\">current set of issues</a> with the generator, or if\n                            you don't see your issue or want to suggest a new feature, add\n                            it <a href=\"https://github.com/KeeganW/ti4/issues/new\">to my issue tracker</a>. Thanks for checking\n                            this out!\n                        </p>\n                    </div>\n                </div>\n\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\n                    &#169; Keegan Williams 2021\n                </div>\n            </div>\n        );\n    }\n}\nexport default MainOverview;","import React from \"react\";\nimport './MainMap.css';\nimport boardData from \"../data/boardData.json\";\nimport {Arrow90degLeft, Arrow90degRight, ArrowRepeat, Check, Lock, X} from \"react-bootstrap-icons\";\nimport ReactTooltip from \"react-tooltip\";\nimport $ from \"jquery\";\n\nclass MainMap extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.toggleControls = this.toggleControls.bind(this);\n        this.getRotationDegrees = this.getRotationDegrees.bind(this);\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        ReactTooltip.rebuild();\n    }\n\n    toggleControls(event) {\n        const splitArray = event.target.id.split(\"-\")\n        const targetName = splitArray[0];\n        const tileNumber = Number(splitArray[splitArray.length - 1]);\n        const systemNumber = this.props.getTileNumber(this.props.tiles[tileNumber]);\n\n        if (targetName === \"tile\") {\n            let newTileClicked = -1;\n            \n            // Ensure that the tile is a different tile, and it is not an empty tile\n            if (this.props.tileClicked !== tileNumber && systemNumber !== -1 && systemNumber !== 0) {\n                newTileClicked = tileNumber;\n            }\n            this.props.updateTileClicked(newTileClicked);\n        } else if (targetName === \"rotate\") {\n            const rotationDirection = splitArray[1];\n            let tile = $(\"#tile-\" + tileNumber);\n            let degrees = this.getRotationDegrees(tile);\n\n            if (rotationDirection === \"left\") {\n                degrees -= 60;\n            } else if (rotationDirection === \"right\") {\n                degrees += 60;\n            }\n            if (degrees < 0) degrees += 360\n            let rotationAngle = (degrees/60) % 6\n\n            let newTiles = [...this.props.tiles];\n            newTiles[tileNumber] = this.props.getTileNumber(newTiles[tileNumber]) + \"-\" + rotationAngle;\n            this.props.updateTiles(newTiles)\n\n            tile.css({'transform' : 'rotate('+ degrees +'deg)'});\n        } else if (targetName === \"swap\") {\n            if (this.props.unusedTiles.length > 0) {\n                // Get new tile to update\n                const randomUnusedTile = this.props.unusedTiles[Math.floor(Math.random() * this.props.unusedTiles.length)];\n\n                // Update tiles\n                let newTiles = [...this.props.tiles];\n                newTiles[tileNumber] = randomUnusedTile;\n                this.props.updateTiles(newTiles)\n            }\n\n        } else if (targetName === \"lock\") {\n            // Get tile location in locked tiles list\n            let lockedIndex = this.props.lockedTiles.indexOf(systemNumber);\n            let newLockedTiles = this.props.lockedTiles;\n\n            // Either remove it or add it, depending on if it is there already or not\n            if (lockedIndex >= 0) {\n                newLockedTiles.splice(lockedIndex, 1);\n            } else {\n                newLockedTiles.push(systemNumber);\n            }\n\n            this.props.updateLockedTiles(newLockedTiles)\n        } else if (targetName === \"exclude\") {\n            // Get tile location in locked tiles list\n            let excludedIndex = this.props.excludedTiles.indexOf(systemNumber);\n            let newExcludedTiles = this.props.excludedTiles;\n            let newIncludedTiles = this.props.includedTiles;\n\n            // Either remove it or add it, depending on if it is there already or not\n            if (excludedIndex >= 0) {\n                newExcludedTiles.splice(excludedIndex, 1);\n            } else {\n                newExcludedTiles.push(systemNumber);\n                // Check if is included. If so, remove it\n                let includedIndex = this.props.includedTiles.indexOf(systemNumber);\n                if (includedIndex >= 0) {\n                    newIncludedTiles.splice(includedIndex, 1);\n                }\n            }\n\n            // Update the list\n            this.props.updateInExcludedTiles(newIncludedTiles, newExcludedTiles)\n        } else if (targetName === \"include\") {\n            // Get tile location in locked tiles list\n            let includedIndex = this.props.includedTiles.indexOf(systemNumber);\n            let newIncludedTiles = this.props.includedTiles;\n            let newExcludedTiles = this.props.excludedTiles;\n\n            // Either remove it or add it, depending on if it is there already or not\n            if (includedIndex >= 0) {\n                newIncludedTiles.splice(includedIndex, 1);\n            } else {\n                newIncludedTiles.push(systemNumber);\n                // Check if is excluded. If so, remove it\n                let excludedIndex = this.props.excludedTiles.indexOf(systemNumber);\n                if (excludedIndex >= 0) {\n                    newExcludedTiles.splice(excludedIndex, 1);\n                }\n            }\n\n            // Update the list\n            this.props.updateInExcludedTiles(newIncludedTiles, newExcludedTiles)\n        }\n    }\n\n    getRotationDegrees(obj) {\n        let matrix = obj.css(\"-webkit-transform\") ||\n            obj.css(\"-moz-transform\")    ||\n            obj.css(\"-ms-transform\")     ||\n            obj.css(\"-o-transform\")      ||\n            obj.css(\"transform\");\n        let angle = 0;\n        if(matrix !== 'none') {\n            let values = matrix.split('(')[1].split(')')[0].split(',');\n            let a = values[0];\n            let b = values[1];\n            angle = Math.round(Math.atan2(b, a) * (180/Math.PI));\n        }\n\n        if(angle < 0) angle +=360;\n        return angle;\n    }\n\n    render() {\n        const mapTiles = []\n        const style = {position: \"absolute\"}\n        const hidden = {display: \"none\"}\n\n        // Loop over 0 to pok board size, and add in the tile objects to be displayed\n        for (let tileNumber = 0; tileNumber < boardData.pokSize; tileNumber++) {\n            let systemNumber = this.props.getTileNumber(this.props.tiles[tileNumber])\n\n            // Add the tile to the array of tiles to be displayed, if they are valid tiles\n            if (systemNumber !== undefined) {\n                mapTiles.push(\n                    <div key={\"tile-wrapper-\" + tileNumber} id={\"tile-wrapper-\" + tileNumber} className=\"tile-wrapper\" style={style} onClick={this.toggleControls}>\n                        <button id={\"rotate-left-\" + tileNumber} className={\"btn btn-primary tile-control rotate-left\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\")} data-tip=\"Rotate tile left\" data-place=\"top\" >\n                            <Arrow90degLeft id={\"rotate-left-svg-\" + tileNumber} className={\"icon\"}/>\n                        </button>\n                        <button id={\"lock-\" + tileNumber} className={\"btn btn-primary tile-control lock\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\") + (this.props.lockedTiles.indexOf(systemNumber) >= 0 ? \" active\" : \"\")} data-tip=\"Keep tile here on generation\" >\n                            <Lock id={\"lock-svg-\" + tileNumber} className={\"icon\"}/>\n                        </button>\n                        <button id={\"rotate-right-\" + tileNumber} className={\"btn btn-primary tile-control rotate-right\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\")} data-tip={\"Rotate tile right\"} >\n                            <Arrow90degRight id={\"rotate-right-svg-\" + tileNumber} className={\"icon\"}/>\n                        </button>\n                        <span id={\"number-\" + tileNumber} className={\"overlay\"} style={hidden}>{tileNumber}</span>\n                        <img id={\"tile-\" + tileNumber}\n                             className=\"tile\"\n                             src={window.location.origin + window.location.pathname + \"/tiles/ST_\" + systemNumber + \".png\"}\n                             draggable=\"true\" onDragStart={this.props.drag} onDrop={this.props.drop} onDragOver={this.props.allowDrop} onDragEnter={this.props.dragEnter} onDragLeave={this.props.dragLeave} onTouchMove={this.props.touchMove} onTouchEnd={this.props.touchEnd}\n                             alt={\"Twilight Imperium 4 Tile Number \" + tileNumber + \" and System Number \" + systemNumber + \".\"}\n                        />\n                        <svg id={\"underlay-\" + tileNumber} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"underlay\" fill=\"currentColor\">\n                            <polygon points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\n                        </svg>\n                        <button id={\"exclude-\" + tileNumber} className={\"btn btn-primary tile-control exclude\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\") + (this.props.excludedTiles.indexOf(systemNumber) >= 0 ? \" active\" : \"\")} data-tip={\"Exclude from generation\"} data-place=\"bottom\" >\n                            <X id={\"exclude-svg-\" + tileNumber} className={\"icon\"}/>\n                        </button>\n                        <button id={\"swap-\" + tileNumber} className={\"btn btn-primary tile-control swap\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\")} data-tip={\"Swap with an extra tile\"} data-place=\"bottom\" >\n                            <ArrowRepeat id={\"swap-svg-\" + tileNumber} className={\"icon\"}/>\n                        </button>\n                        <button id={\"include-\" + tileNumber} className={\"btn btn-primary tile-control include\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\") + (this.props.includedTiles.indexOf(systemNumber) >= 0 ? \" active\" : \"\")} data-tip={\"Always include in generation\"} data-place=\"bottom\" >\n                            <Check id={\"include-svg-\" + tileNumber} className={\"icon\"}/>\n                        </button>\n                    </div>\n                )\n            }\n        }\n        \n        return (\n            <div id=\"map\" className={\"map center-map \" + (this.props.visible ? \"\" : \"d-none\")}>\n                {mapTiles}\n            </div>\n        );\n    }\n}\nexport default MainMap;","import React from \"react\";\nimport Modal from \"react-bootstrap/Modal\";\nimport $ from 'jquery';\nimport {exportComponentAsPNG} from \"react-component-export-image\";\n\nclass ShareMapModal extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.getTTSTileString = this.getTTSTileString.bind(this);\n        this.copyTileStringToClipboard = this.copyTileStringToClipboard.bind(this);\n        this.copyLinkToClipboard = this.copyLinkToClipboard.bind(this);\n        this.removeTrailing = this.removeTrailing.bind(this);\n        this.sleep = this.sleep.bind(this);\n        this.downloadImage = this.downloadImage.bind(this);\n    }\n\n    /**\n     * Using writeText, copy the tiles currently being displayed to the user's clipboard.\n     * @returns {string} A string representing the tiles in the TTS format\n     */\n    getTTSTileString() {\n        // Get the current tiles\n        let tileString = [...this.props.tiles];\n        tileString = this.removeTrailing(tileString);\n\n        // Remove mecatol rex\n        tileString.shift();\n\n        tileString = tileString.toString();\n        tileString = tileString.replaceAll(\",-1\", \",0\");  // Remove the -1s because it is unused\n        tileString = tileString.replaceAll(\",\", \" \");  // Remove commas from old array\n        tileString = tileString.replaceAll(/(\\d+)-\\d/gm, \"$1\");  // Remove rotation for non hyperlanes\n        tileString = tileString.replaceAll(\"-\", \"\");  // Remove rotation dash in hyperlanes\n\n        return tileString\n    }\n\n    /**\n     * Copies the TTS tile string to the clipboard\n     */\n    copyTileStringToClipboard() {\n        let tileString = this.getTTSTileString();\n        console.log(\"Here is the tile string for use with this mod: https://steamcommunity.com/sharedfiles/filedetails/?id=1288687076\")\n        console.log(tileString)\n        navigator.clipboard.writeText(tileString);\n    }\n\n    /**\n     * Copies the page link to the clipboard\n     */\n    copyLinkToClipboard() {\n        navigator.clipboard.writeText(window.location.href);\n    }\n\n    /**\n     * Removes any trailing -1s from a tile string.\n     * @param {number[]} tiles the tile string to clean\n     * @returns {number[]} the clean tile string\n     */\n    removeTrailing(tiles) {\n        while(tiles[tiles.length - 1] === -1){\n            tiles.pop();\n        }\n        return tiles;\n    }\n\n    /**\n     * Has the thread wait for a certain amount of time before continuing.\n     * @param ms The number of milliseconds before continuing\n     * @returns {Promise<unknown>} A timeout\n     */\n    sleep(ms) {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    /**\n     * Downloads an image of the map to the user's computer.\n     * @returns {Promise<void>} null\n     */\n    async downloadImage() {\n        // Set the button as active to let the user know the action is still happening\n        $(\"#downloadMapButton\").addClass(\"active\")\n\n        // Scroll so that the image is centered properly\n        window.scrollTo(0, 0);\n\n        // Export as a png with a blank background. Scale so its not a giant file\n        await exportComponentAsPNG(this.props.map, {\n            fileName: \"ti4-map\",\n            html2CanvasOptions: {backgroundColor: null, scrollX: 0, scrollY: -window.pageYOffset, scale: 1.5}\n        })\n\n        // Wait a little bit, then un activate the button.\n        await this.sleep(750);\n        $(\"#downloadMapButton\").removeClass(\"active\")\n    }\n\n    render() {\n        let tileString = this.getTTSTileString();\n        return (\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\n                <Modal.Header closeButton>\n                    <Modal.Title>Share Map</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <div className=\"input-group mb-3\">\n                        <input type=\"text\" className=\"form-control\" value={window.location.href} readOnly\n                               aria-label=\"Page Link\" aria-describedby=\"basic-addon2\" />\n                        <div className=\"input-group-append\">\n                            <button className=\"btn btn-primary\" type=\"button\" onClick={this.copyLinkToClipboard}>Copy Link</button>\n                        </div>\n                    </div>\n\n                    <div className=\"input-group mb-3\">\n                        <input type=\"text\" className=\"form-control\" value={tileString} readOnly\n                               aria-label=\"Tile String\" aria-describedby=\"basic-addon2\" />\n                        <div className=\"input-group-append\">\n                            <button className=\"btn btn-primary\" type=\"button\" onClick={this.copyTileStringToClipboard}>Copy TTS String</button>\n                        </div>\n                    </div>\n\n                    <div className=\"input-group mb-3 justify-content-center\">\n                        <button id=\"downloadMapButton\" className=\"btn btn-primary\" type=\"button\" onClick={this.downloadImage}>Download Map Image</button>\n                    </div>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\nexport default ShareMapModal;","import React from \"react\";\nimport Modal from \"react-bootstrap/Modal\";\nimport $ from 'jquery';\nimport {exportComponentAsPNG} from \"react-component-export-image\";\n\nclass LoadMapModal extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            currentInputTiles: \"\",\n        }\n\n        this.updateInputTiles = this.updateInputTiles.bind(this);\n        this.loadTiles = this.loadTiles.bind(this);\n    }\n\n    /**\n     * Take the entered TTS string and parse it into the format that we use for tiles.\n     */\n    parseTTSTileString() {\n        // Get the current tiles\n        let inputTiles = this.props.removeTrailing(this.state.currentInputTiles);\n\n        // Split the tiles up into an array\n        inputTiles = inputTiles.toString();\n        inputTiles = inputTiles.split(\" \")\n\n        // Add m-rex to the front, which TTS doesn't include\n        inputTiles.unshift(\"18\")\n\n        inputTiles = inputTiles.map((value, index) => {\n            let newValue = value\n            const aIndex = newValue.indexOf(\"A\")\n            const bIndex = newValue.indexOf(\"B\")\n            if (aIndex >= 0 || bIndex >= 0) {\n                const sideLocation = aIndex >= 0 ? aIndex : bIndex\n                const rotation = newValue.substring(sideLocation + 1)\n                newValue = newValue.substring(0, sideLocation + 1) + \"-\" + rotation\n            }\n            return newValue\n        })\n\n        // Use these new tiles to update the map\n        this.setState({\n            currentInputTiles: \"\"\n        }, () => {\n            this.props.updateTiles(inputTiles, undefined, true);\n            this.props.hideModal()\n        } );\n    }\n\n    /**\n     * Update the state for the text input\n     * @param event The user type event that changed this text box\n     */\n    updateInputTiles(event) {\n        if (event.target.value || event.target.value === \"\") {\n            this.setState({\n                currentInputTiles: event.target.value,\n            });\n        }\n    }\n\n    /**\n     * Loads tiles entered into the map\n     * @param event The submit event that triggered this function\n     */\n    loadTiles(event) {\n        // Don't actually submit the form when nothing is typed\n        if (event !== undefined || this.state.currentInputTiles === undefined || this.state.currentInputTiles === \"\") {\n            event.preventDefault();\n        }\n\n        // TODO: validate input\n        // Turn TTS string to tiles\n        this.parseTTSTileString()\n    }\n\n    render() {\n        return (\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\n                <Modal.Header closeButton>\n                    <Modal.Title>Load Map</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <form id=\"generateForm\" onSubmit={this.loadTiles}>\n                        <div className=\"input-group mb-3\">\n                            <input type=\"text\" className=\"form-control\" id=\"inputMapString\" name=\"userInputTiles\"\n                                   placeholder=\"Enter a tile string (eg. 79 60 50 31...)\" aria-label=\"Map String\"\n                                   aria-describedby=\"basic-addon2\"\n                                   value={this.state.currentInputTiles} onChange={this.updateInputTiles}\n                                    />\n                            <div className=\"input-group-append\">\n                                <button className=\"btn btn-primary\" type=\"submit\" >Load Map</button>\n                            </div>\n                        </div>\n                    </form>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\nexport default LoadMapModal;","import React from \"react\";\nimport {CardImage, Dash, InfoCircle, Plus, Share, Upload} from \"react-bootstrap-icons\";\nimport ShareMapModal from \"./ShareMapModal\";\nimport LoadMapModal from \"./LoadMapModal\";\n\nclass MapControls extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            shareMapHelp: false,\n            loadMapHelp: false,\n        }\n\n        this.toggleShareMapHelp = this.toggleShareMapHelp.bind(this);\n        this.toggleLoadMapHelp = this.toggleLoadMapHelp.bind(this);\n    }\n\n    /**\n     * Toggle the modal for the sharing page.\n     * @param event The event trigger for the toggle.\n     */\n    toggleShareMapHelp(event) {\n        this.setState({\n            shareMapHelp: !this.state.shareMapHelp\n        })\n    }\n\n    /**\n     * Toggle the modal for the load map page.\n     * @param event The event trigger for the toggle.\n     */\n    toggleLoadMapHelp(event) {\n        this.setState({\n            loadMapHelp: !this.state.loadMapHelp\n        })\n    }\n\n    render() {\n        return (\n            <div id={\"map-controls\"}>\n                <div id=\"zoomButtons\" className={\"btn-group-justified btn-group-sm btn-group-vertical\" + (this.props.visible ? \"\" : \" d-none\")}>\n                    <button className=\"btn btn-primary\" id=\"zoomPlus\" onClick={this.props.zoomPlus} data-tip=\"Or Hold CTRL and Use Scroll Wheel\" data-place=\"left\" >\n                        <Plus className=\"icon\" />\n                    </button>\n                    <button className=\"btn btn-primary\" id=\"zoomMinus\" onClick={this.props.zoomMinus}>\n                        <Dash className=\"icon\" />\n                    </button>\n                </div>\n    \n                <div id=\"hexOverlay\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.props.toggleOverlay}>\n                    <button className={\"btn btn-primary\" + (this.props.overlayVisible ? \" active\": \"\")} id=\"showHexOverlay\" data-tip=\"Tile Number Overlay\" data-place=\"left\" >\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 194.78 169.62\" className=\"icon\" fill=\"currentColor\">\n                            <polygon className=\"overlay-cls-1\" points=\"148.03 4 51.81 4 4.61 86.92 52.02 169.84 148.03 169.84 195.03 86.92 148.03 4\"/>\n                            <text className=\"overlay-cls-2\" transform=\"translate(27.09 132.03)\">18</text>\n                        </svg>\n                    </button>\n                </div>\n    \n                <div id=\"extraTilesButton\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.props.toggleExtraTiles}>\n                    <button className={\"btn btn-primary\" + (this.props.extraTilesVisible ? \" active\": \"\")} id=\"showExtraTiles\" data-tip=\"Unused Tiles\" data-place=\"left\" >\n                        <svg id=\"showExtraTilesSvg\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"icon\" fill=\"currentColor\">\n                            <polygon id=\"showExtraTilesPoly\" points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\n                        </svg>\n                    </button>\n                </div>\n\n                <div id=\"moreInfoButton\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.props.toggleMoreInfo}>\n                    <button className={\"btn btn-primary\" + (this.props.moreInfoVisible ? \" active\": \"\")} id=\"showMoreInfo\" data-tip=\"Assets Adjacent to Home\" data-place=\"left\" >\n                        <InfoCircle id=\"showMoreInfoSvg\" className=\"icon\" />\n                    </button>\n                </div>\n\n                <div id=\"shareMapButton\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.toggleShareMapHelp}>\n                    <button className={\"btn btn-primary\"} id=\"shareMapInfo\" data-tip=\"Share This Map\" data-place=\"left\" >\n                        <Share id=\"shareMapSvg\" className=\"icon\" />\n                    </button>\n                </div>\n\n                <div id=\"loadMapButton\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.toggleLoadMapHelp}>\n                    <button className={\"btn btn-primary\"} id=\"loadMapInfo\" data-tip=\"Load a Map\" data-place=\"left\" >\n                        <Upload id=\"loadMapSvg\" className=\"icon\" />\n                    </button>\n                </div>\n\n                <ShareMapModal visible={this.state.shareMapHelp} hideModal={this.toggleShareMapHelp}\n                               tiles={this.props.tiles} map={this.props.map}\n                />\n\n                <LoadMapModal visible={this.state.loadMapHelp} hideModal={this.toggleLoadMapHelp}\n                              tiles={this.props.tiles} updateTiles={this.props.updateTiles}\n                              removeTrailing={this.props.removeTrailing}\n                />\n\n                <div id=\"toggleBackgroundButton\" className={\"btn-group-justified btn-group-sm\"} onClick={this.props.toggleBackground}>\n                    <button className={\"btn btn-primary\"} id=\"toggleBackground\" data-tip=\"Toggle Background Animation\">\n                        <CardImage id=\"toggleBackgroundSvg\" className=\"icon\" />\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\nexport default MapControls;","import React from \"react\";\nimport {ArrowBarLeft, ArrowBarRight} from \"react-bootstrap-icons\";\n\nclass OptionsControls extends React.Component {\n    render() {\n        return (\n            <div className=\"controls btn-group-justified btn-group-sm\">\n                <button type=\"button\" id=\"toggleOptions\" className={\"btn btn-primary\" + (this.props.visible ? \"\" : \" hidden\") + (this.props.isMobileView ? \" full-screen\" : \"\")} onClick={this.props.toggleOptions}>\n                    <ArrowBarRight className={\"icon icon-contract\"} />\n                    <ArrowBarLeft className={\"icon icon-expand\"} />\n                </button>\n            </div>\n        );\n    }\n}\nexport default OptionsControls;","import React from \"react\";\nimport Modal from \"react-bootstrap/Modal\";\n\nclass HelpModal extends React.Component {\n    render() {\n        return (\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\n                <Modal.Header closeButton>\n                    <Modal.Title>{this.props.title}</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <div dangerouslySetInnerHTML={{__html: this.props.content}} />\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\nexport default HelpModal;","import React from \"react\";\nimport Modal from \"react-bootstrap/Modal\";\n\nclass SetPlayerNameModal extends React.Component {\n    render() {\n        return (\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\n                <Modal.Header closeButton>\n                    <Modal.Title>Set Player Names</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <form id={\"playerNameForm\"}>\n                        {this.props.currentPlayerNames.map((x, i) => {\n                            return (\n                                <div className={\"form-group\"} key={\"set-names-\" + i}>\n                                    <label htmlFor={\"player\" + (i+1) + \"Name\"}>Player {(i+1)}</label>\n                                    <input className={\"form-control\"} name={\"playerName\" + i} type={\"text\"} placeholder={\"P\" + (i+1)} defaultValue={x} onChange={this.props.handleNameChange} />\n                                </div>\n                            )\n                        })}\n                    </form>\n\n\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\nexport default SetPlayerNameModal;","import React from \"react\";\nimport Modal from \"react-bootstrap/Modal\";\n\nclass SetRacesModal extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            searchString: \"\"\n        }\n\n        this.updateSearchString = this.updateSearchString.bind(this);\n    }\n\n    updateSearchString(event) {\n        this.setState({\n            searchString: event.target.value,\n        })\n    }\n\n    render() {\n        let visibleRaces = this.props.races\n        if (this.props.useProphecyOfKings) {\n            visibleRaces = visibleRaces.concat(this.props.pokRaces)\n        }\n\n        let breakStyle = {\n            \"border-bottom\": \"1px solid #dee2e6\"\n        }\n\n        return (\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\n                <Modal.Header closeButton>\n                    <Modal.Title>Set Races</Modal.Title>\n                </Modal.Header>\n                <div style={breakStyle} >\n                    <button type=\"button\" name={\"all\"} className=\"btn btn-outline-primary m-2 ml-3\" onClick={this.props.handleRacesChange}>Select All</button>\n                    <button type=\"button\" name={\"none\"} className=\"btn btn-outline-primary m-2\" onClick={this.props.handleRacesChange}>Deselect All</button>\n                </div>\n                <Modal.Body>\n                    <form id={\"includedRacesForm\"}>\n                        <div className={\"form-group\"}>\n                            <input className={\"form-control\"} id={\"filterRaces\"} type={\"text\"} placeholder={\"Filter Races...\"} value={this.state.searchString} onChange={this.updateSearchString} />\n                        </div>\n                        {visibleRaces.map((raceName, raceIndex) => {\n                            let raceVisible = raceName.toLowerCase().includes(this.state.searchString);\n                            return (\n                                <div className={\"custom-control custom-checkbox mb-3 races\" + (raceVisible ? \"\" : \" d-none\")} key={\"set-races-\" + raceIndex}>\n                                    <input className={\"custom-control-input\"} name={raceName} type={\"checkbox\"} id={\"include\" + raceName.replace(\" \", \"\")} checked={this.props.currentRaces.indexOf(raceName) > -1} onChange={this.props.handleRacesChange} />\n                                    <label className={\"custom-control-label d-flex\"} htmlFor={\"include\" + raceName.replace(\" \", \"\")}>{raceName}</label>\n                                </div>\n                            )\n                        })}\n                    </form>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\nexport default SetRacesModal;","import React from \"react\";\nimport {QuestionCircle} from \"react-bootstrap-icons\";\nimport boardData from \"../data/boardData.json\";\nimport tileData from \"../data/tileData.json\";\nimport raceData from \"../data/raceData.json\";\nimport adjacencyData from \"../data/adjacencyData.json\";\nimport HelpModal from \"./HelpModal\";\nimport SetPlayerNameModal from \"./SetPlayerNameModal\";\nimport SetRacesModal from \"./SetRacesModal\";\n\n\nclass MapOptions extends React.Component {\n    constructor(props) {\n        super(props);\n        const startingValues = {\n            numberOfPlayers: [2, 3, 4, 5, 6],\n            pokNumberOfPlayers: [7, 8],\n            boardStyles: {\n                2: Object.keys(boardData.styles[\"2\"]).map((key) => key),\n                3: Object.keys(boardData.styles[\"3\"]).map((key) => key),\n                4: Object.keys(boardData.styles[\"4\"]).map((key) => key),\n                5: Object.keys(boardData.styles[\"5\"]).map((key) => key),\n                6: Object.keys(boardData.styles[\"6\"]).map((key) => key === \"large\" ? null : key).filter(x => x),\n            },\n            boardStylesPok: {\n                2: Object.keys(boardData.styles[\"2\"]).map((key) => key),\n                3: Object.keys(boardData.styles[\"3\"]).map((key) => key),\n                4: Object.keys(boardData.styles[\"4\"]).map((key) => key),\n                5: Object.keys(boardData.styles[\"5\"]).map((key) => key),\n                6: Object.keys(boardData.styles[\"6\"]).map((key) => key),\n                7: Object.keys(boardData.styles[\"7\"]).map((key) => key),\n                8: Object.keys(boardData.styles[\"8\"]).map((key) => key),\n            },\n            pickStyles: [\"balanced\", \"random\", \"resource\", \"influence\", \"custom\"],\n            placementStyles: [\"slice\", \"initial\", \"home\", \"random\"],\n            races: [...raceData[\"races\"]],\n            pokRaces: [...raceData[\"pokRaces\"]],\n            homeworlds: raceData[\"homeSystems\"],\n            pokHomeworlds: raceData[\"pokHomeSystems\"]\n        }\n        const startingPlayers = 6;\n\n        this.state = {\n            optionsPossible: startingValues,\n            currentNumberOfPlayers: startingPlayers,\n            currentNumberOfPlayersOptions: startingValues[\"numberOfPlayers\"],\n            currentBoardStyleOptions: startingValues[\"boardStyles\"][startingPlayers],\n            currentBoardStyle: startingValues[\"boardStyles\"][startingPlayers][0],\n            currentPickStyle: startingValues[\"pickStyles\"][0],\n            currentPlacementStyle: startingValues[\"placementStyles\"][0],\n            currentSeed: \"\",\n            userSetSeed: false,\n            pickRaces: false,\n            pickMultipleRaces: false,\n            shuffleBoards: false,\n            reversePlacementOrder: false,\n            ensureRacialAnomalies: true,\n            generated: false,\n\n            pickRacesHelp: false,\n            boardStyleHelp: false,\n            pickStyleHelp: false,\n            placementStyleHelp: false,\n            setPlayerNamesHelp: false,\n            setRacesHelp: false,\n            pickMultipleRacesHelp: false,\n            shufflePriorityHelp: false,\n            reversePlacementOrderHelp: false,\n            ensureRacialAnomaliesHelp: false,\n\n            resourceWeight: 70,\n            influenceWeight: 30,\n            planetCountWeight: 15,\n            specialtyWeight: 50,\n            anomalyWeight: 10,\n            wormholeWeight: 25,\n\n            shuffleThreshold: 5,\n        };\n\n        this.handleInputChange = this.handleInputChange.bind(this);\n        this.handleNameChange = this.handleNameChange.bind(this);\n        this.handleRacesChange = this.handleRacesChange.bind(this);\n        this.updatePok = this.updatePok.bind(this);\n        this.updatePlayerCount = this.updatePlayerCount.bind(this);\n        this.updateBoardStyle = this.updateBoardStyle.bind(this);\n        this.updateSeed = this.updateSeed.bind(this);\n\n        this.ensureAnomalies = this.ensureAnomalies.bind(this);\n        this.ensureWormholesForType = this.ensureWormholesForType.bind(this);\n\n        this.updateBoardStyleOptions = this.updateBoardStyleOptions.bind(this); // TODO is the bind needed?\n\n        this.encodeSettings = this.encodeSettings.bind(this);\n        this.decodeSettings = this.decodeSettings.bind(this);\n\n        this.generateBoard = this.generateBoard.bind(this);\n        this.getNewTileSet = this.getNewTileSet.bind(this);\n\n        this.togglePickRacesHelp = this.togglePickRacesHelp.bind(this);\n        this.toggleBoardStyleHelp = this.toggleBoardStyleHelp.bind(this);\n        this.togglePickStyleHelp = this.togglePickStyleHelp.bind(this);\n        this.togglePlacementStyleHelp = this.togglePlacementStyleHelp.bind(this);\n        this.toggleSetPlayerNamesHelp = this.toggleSetPlayerNamesHelp.bind(this);\n        this.toggleSetRacesHelp = this.toggleSetRacesHelp.bind(this);\n        this.togglePickMultipleRacesHelp = this.togglePickMultipleRacesHelp.bind(this);\n        this.toggleShufflePriorityHelp = this.toggleShufflePriorityHelp.bind(this);\n        this.toggleReversePlacementOrderHelp = this.toggleReversePlacementOrderHelp.bind(this);\n        this.toggleEnsureRacialAnomaliesHelp = this.toggleEnsureRacialAnomaliesHelp.bind(this);\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        const value = target.type === 'checkbox' ? target.checked : target.value;\n        const name = target.name;\n\n        this.setState({\n            [name]: value\n        });\n    }\n\n    handleNameChange(event) {\n        let nameIndex = parseInt(event.target.name.substring(10))\n        let newPlayerNames = this.props.currentPlayerNames\n        newPlayerNames[nameIndex] = event.target.value\n\n        this.setState({\n            currentPlayerNames: newPlayerNames\n        })\n    }\n\n    handleRacesChange(event) {\n        let race = event.target.name;\n        let newCurrentRaces = this.props.currentRaces;\n        if (race === \"none\") {  // The deselect all option\n            newCurrentRaces = []\n        } else if (race === \"all\") {  // The deselect all option\n            if (this.props.useProphecyOfKings) {\n                newCurrentRaces = [...this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)]\n            } else {\n                newCurrentRaces = [...this.state.optionsPossible.races]\n            }\n        } else {\n            let indexToToggle = newCurrentRaces.indexOf(race)\n            if (indexToToggle >= 0) {\n                newCurrentRaces.splice(indexToToggle, 1)\n            } else {\n                newCurrentRaces.push(race)\n            }\n        }\n\n        this.props.updateRaces(newCurrentRaces);\n    }\n\n    updatePok(event) {\n        let boardOptions = this.state.optionsPossible.boardStyles;\n        if (event.target.checked) {\n            boardOptions = this.state.optionsPossible.boardStylesPok;\n            this.setState({\n                currentNumberOfPlayersOptions: this.state.optionsPossible.numberOfPlayers.concat(this.state.optionsPossible.pokNumberOfPlayers),\n                currentBoardStyle: boardOptions[this.state.currentNumberOfPlayers][0],\n                currentBoardStyleOptions: boardOptions[this.state.currentNumberOfPlayers],\n            }, () => {\n                this.props.updateRaces([...this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)]);\n                this.props.toggleProphecyOfKings(event);\n            });\n        } else {\n            this.setState({\n                currentNumberOfPlayers: this.state.currentNumberOfPlayers > 6 ? 6 : this.state.currentNumberOfPlayers,\n                currentNumberOfPlayersOptions: this.state.optionsPossible.numberOfPlayers,\n                currentBoardStyle: this.state.currentNumberOfPlayers > 6 ? boardOptions[\"6\"][0] : this.state.currentBoardStyle,\n                currentBoardStyleOptions: this.state.currentNumberOfPlayers > 6 ? boardOptions[\"6\"] : boardOptions[this.state.currentNumberOfPlayers],\n            }, () => {\n                this.props.updateRaces([...this.state.optionsPossible.races]);\n                this.props.toggleProphecyOfKings(event);\n            });\n        }\n    }\n\n    updatePlayerCount(event) {\n        this.setState({\n            currentNumberOfPlayers: parseInt(event.target.value),\n        }, () => {\n            this.updateBoardStyleOptions(event)\n        });\n    }\n\n    updateBoardStyle(event) {\n        this.setState({\n            currentBoardStyle: event.target.value,\n        }, () => {\n            if (this.state.generated) {\n                this.generateBoard(event)\n            }\n        });\n    }\n\n    updateBoardStyleOptions(event) {\n        let boardOptions = this.state.optionsPossible.boardStyles;\n        if (this.props.useProphecyOfKings) {\n            boardOptions = this.state.optionsPossible.boardStylesPok;\n        }\n        this.setState({\n            currentBoardStyleOptions: boardOptions[this.state.currentNumberOfPlayers],\n            currentBoardStyle: boardOptions[this.state.currentNumberOfPlayers][0],\n        }, () => {\n            if (this.state.generated) {\n                this.generateBoard(event)\n            }\n        });\n    }\n\n    updateSeed(event) {\n        let newSeed = parseInt(event.target.value)\n        if (!isNaN(newSeed) || event.target.value === \"\") {\n            this.setState({\n                currentSeed: event.target.value,\n                userSetSeed: event.target.value !== \"\"  // Ignore user entry if the value is blank\n            });\n        }\n    }\n\n    capitalize(str) {\n        return str.charAt(0).toUpperCase() + str.slice(1);\n    }\n\n    shuffle(array) {\n        let m = array.length, t, i;\n        let seed = this.state.currentSeed.valueOf();\n\n        // While there remain elements to shuffle…\n        while (m) {\n            // Pick a remaining element…\n            i = Math.floor(this.random(seed) * m--);\n\n            // And swap it with the current element.\n            t = array[m];\n            array[m] = array[i];\n            array[i] = t;\n            ++seed\n        }\n\n        return array;\n    }\n\n    random(seed) {\n        let x = Math.sin(seed++) * 10000;\n        return x - Math.floor(x);\n    }\n\n    encodeSettings() {\n        let encodedSettings = \"\";\n\n        encodedSettings += this.props.useProphecyOfKings ? \"T\" : \"F\";\n        encodedSettings += this.state.currentNumberOfPlayers.toString();\n        encodedSettings += this.state.currentBoardStyleOptions.indexOf(this.state.currentBoardStyle).toString();\n        encodedSettings += this.state.optionsPossible.placementStyles.indexOf(this.state.currentPlacementStyle).toString();\n        encodedSettings += this.state.optionsPossible.pickStyles.indexOf(this.state.currentPickStyle).toString();\n        if (this.state.currentPickStyle === \"custom\") {\n            encodedSettings += this.state.resourceWeight.toString().padStart(3, \"0\");\n            encodedSettings += this.state.influenceWeight.toString().padStart(3, \"0\");\n            encodedSettings += this.state.planetCountWeight.toString().padStart(3, \"0\");\n            encodedSettings += this.state.specialtyWeight.toString().padStart(3, \"0\");\n            encodedSettings += this.state.anomalyWeight.toString().padStart(3, \"0\");\n            encodedSettings += this.state.wormholeWeight.toString().padStart(3, \"0\");\n        }\n        encodedSettings += this.state.currentSeed.toString().padStart(4, \"0\");\n        encodedSettings += this.state.shuffleBoards ? \"T\" : \"F\";\n        encodedSettings += this.state.reversePlacementOrder ? \"T\" : \"F\";\n        encodedSettings += this.state.pickRaces ? \"T\" : \"F\";\n        if (this.state.pickRaces) {\n            encodedSettings += this.state.ensureRacialAnomalies ? \"T\" : \"F\";\n            let combinedRaces = this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)\n            if ((this.props.useProphecyOfKings === false && this.props.currentRaces.length !== this.state.optionsPossible.races.length) ||\n                (this.props.useProphecyOfKings === true && this.props.currentRaces.length !== combinedRaces.length)) {\n                // Need to encode all races, because it is not the default\n                for (let race of this.props.currentRaces) {\n                    if (combinedRaces.indexOf(race) >= 0) {\n                        encodedSettings += combinedRaces.indexOf(race).toString().padStart(2, \"0\");\n                    }\n                }\n            }\n            let changedPlayerName = false;\n            let playerNames = \"|\"\n            for (let playerName of this.props.currentPlayerNames) {\n                if (playerName !== \"\") {\n                    changedPlayerName = true;\n                }\n                playerNames += playerName + \"|\";\n            }\n            if (changedPlayerName) {\n                encodedSettings += playerNames\n                encodedSettings = encodedSettings.slice(0, -1)\n            }\n        }\n\n        return encodedSettings;\n    }\n\n    decodeSettings(newSettings, newTiles) {\n        let currentIndex = 0;\n\n        // Prophecy of Kings\n        let useProphecyOfKings = newSettings[currentIndex] === \"T\";\n        currentIndex += 1;\n\n        // Number of Players\n        let currentNumberOfPlayers = Number(newSettings[currentIndex]);\n        currentIndex += 1;\n        let currentNumberOfPlayersOptions = useProphecyOfKings ? this.state.optionsPossible.numberOfPlayers.concat(this.state.optionsPossible.pokNumberOfPlayers) : this.state.optionsPossible.numberOfPlayers;\n\n        // Board Style\n        let currentBoardStyleOptions = useProphecyOfKings ? this.state.optionsPossible.boardStylesPok[currentNumberOfPlayers] : this.state.optionsPossible.boardStyles[currentNumberOfPlayers];\n        let currentBoardStyle = currentBoardStyleOptions[Number(newSettings[currentIndex])]\n        currentIndex += 1;\n\n        // Placement Style\n        let currentPlacementStyle = this.state.optionsPossible.placementStyles[Number(newSettings[currentIndex])];\n        currentIndex += 1;\n\n        // Pick Style\n        let currentPickStyle = this.state.optionsPossible.pickStyles[Number(newSettings[currentIndex])];\n        currentIndex += 1;\n\n        let resourceWeight = this.state.resourceWeight;\n        let influenceWeight = this.state.influenceWeight;\n        let planetCountWeight = this.state.planetCountWeight;\n        let specialtyWeight = this.state.specialtyWeight;\n        let anomalyWeight = this.state.anomalyWeight;\n        let wormholeWeight = this.state.wormholeWeight;\n        if (currentPickStyle === \"custom\") {\n            resourceWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\n            currentIndex += 3;\n            influenceWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\n            currentIndex += 3;\n            planetCountWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\n            currentIndex += 3;\n            specialtyWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\n            currentIndex += 3;\n            anomalyWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\n            currentIndex += 3;\n            wormholeWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\n            currentIndex += 3;\n        }\n\n        // Current Seed\n        let currentSeed = Number(newSettings.substring(currentIndex, currentIndex + 4));\n        currentIndex += 4;\n\n        // Shuffle Boards\n        let shuffleBoards = newSettings[currentIndex] === \"T\";\n        currentIndex += 1;\n\n        // Reverse Placement Order\n        let reversePlacementOrder = newSettings[currentIndex] === \"T\";\n        currentIndex += 1;\n\n        // Pick Races\n        let pickRaces = newSettings[currentIndex] === \"T\";\n        currentIndex += 1;\n\n        let currentPlayerNames = this.props.currentPlayerNames;\n        let currentRaces = this.props.currentRaces;\n        let ensureRacialAnomalies = this.props.ensureRacialAnomalies;\n        if (pickRaces) {\n            // Ensure Racial Anomalies\n            ensureRacialAnomalies = newSettings[currentIndex] === \"T\";\n            currentIndex += 1;\n            \n            if (newSettings[currentIndex] !== \"|\") {\n                if (newSettings[currentIndex] !== undefined) {\n                    // Custom races, but not all of them\n                    currentRaces = [];\n                    let combinedRaces = this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)\n                    while (newSettings[currentIndex] !== \"|\" && currentIndex !== newSettings.length) {\n                        currentRaces.push(combinedRaces[Number(newSettings.substring(currentIndex, currentIndex + 2))])\n                        currentIndex += 2\n                    }\n                } else {\n                    currentRaces = useProphecyOfKings ? this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces) : this.state.optionsPossible.races;\n                }\n            } else {\n                // No custom races, but player names are specified, so parse them\n                currentPlayerNames = newSettings.substring(currentIndex).split(\"|\").splice(1);\n            }\n        }\n\n        this.setState({\n            currentNumberOfPlayers: currentNumberOfPlayers,\n            currentNumberOfPlayersOptions: currentNumberOfPlayersOptions,\n            currentBoardStyle: currentBoardStyle,\n            currentBoardStyleOptions: currentBoardStyleOptions,\n            currentPlacementStyle: currentPlacementStyle,\n            currentPickStyle: currentPickStyle,\n            resourceWeight: resourceWeight,\n            influenceWeight: influenceWeight,\n            planetCountWeight: planetCountWeight,\n            specialtyWeight: specialtyWeight,\n            anomalyWeight: anomalyWeight,\n            wormholeWeight: wormholeWeight,\n            currentSeed: currentSeed,\n            shuffleBoards: shuffleBoards,\n            reversePlacementOrder: reversePlacementOrder,\n            pickRaces: pickRaces,\n            ensureRacialAnomalies: ensureRacialAnomalies,\n        }, () => {\n            this.props.updateRaces(currentRaces);\n            this.props.updatePlayerNames(currentPlayerNames);\n\n            if ((useProphecyOfKings && !this.props.useProphecyOfKings) || (!useProphecyOfKings && this.props.useProphecyOfKings)) {\n                this.props.toggleProphecyOfKings();\n            }\n\n            if (newTiles.length > 0) {\n                // Tiles were changed after rendering, so we need to display them\n                this.props.updateTiles(newTiles, newSettings);\n            } else {\n                this.props.updateTiles(this.getNewTileSet(useProphecyOfKings, currentRaces), newSettings, false);\n            }\n        })\n\n\n    }\n\n    /**\n     * Create a new board using a custom seed.\n     * @param event The event which triggered this action, to be ignored.\n     */\n    generateBoard(event) {\n        // Don't actually submit the form\n        if (event !== undefined) {\n            event.preventDefault();\n        }\n\n        // Create a random seed to use unless the user has specified one\n        let currentSeed = this.state.currentSeed\n        if (!this.state.userSetSeed) {\n            currentSeed = Math.floor(Math.random() * Math.floor(9999));\n        }\n\n        this.setState({\n            currentSeed: currentSeed,\n            generated: true,\n        }, () => {\n            this.props.updateTiles(this.getNewTileSet(), this.encodeSettings(), true);\n        });\n\n    }\n\n    /**\n     * Create a set of new tiles for the board based on the user's input.\n     */\n    getNewTileSet(useProphecyOfKings, currentRaces) {\n        if (useProphecyOfKings === undefined) {\n            useProphecyOfKings = this.props.useProphecyOfKings\n        }\n\n        // Get an ordered list of board spaces that need to have non-home systems assigned to them\n        let systemIndexes = this.getNewTilesToPlace()\n\n        // Get current races for placing races, and shuffle them around\n        if (currentRaces === undefined) {\n            currentRaces = [...this.props.currentRaces]\n        } else {\n            currentRaces = [...currentRaces]\n        }\n        this.shuffle(currentRaces)\n        currentRaces = currentRaces.slice(0, this.state.currentNumberOfPlayers)\n\n        // Get a set of systems to make the board with, ordered based on user supplied weights\n        let newSystems = this.getNewSystemsToPlace(systemIndexes.length, useProphecyOfKings, currentRaces)\n\n        // Copy a blank map to add to\n        let newTiles = [...boardData.blankMap]\n\n        // Put Mecatol Rex in the middle\n        newTiles[0] = 18\n\n        // Place hyperlanes\n        this.placeHyperlanes(newTiles)\n\n        // Place home planets\n        this.placeHomeSystems(newTiles, currentRaces)\n\n        // Place planets one at a time, using the indexes to place combined with the ordered planet list\n        for (let systemIndex of systemIndexes) {\n            newTiles[systemIndex] = newSystems.shift();\n        }\n\n        // Place any systems that were locked from the previous generation\n        this.placeLockedSystems(newTiles)\n\n        // Check that anomalies and wormholes are not adjacent\n        this.checkAdjacencies(newTiles, useProphecyOfKings)\n\n        // Update the generated flag then update the tiles\n        return newTiles;\n    }\n\n    /**\n     * Generate a list of index on the board that need to be filled with tiles. The various inputs include:\n     * Board Data: Information about what this board looks like, the tiles split into 3 groupings of importance\n     * Random Priority: Whether the first player goes first, or who gets the various picks is randomized\n     * Placement Style: How the groupings of tiles should be added to the board\n     * Reverse Placement Order: Whether the groupsings should be added in reverse order\n     * @returns {number[]} A list of indexes on the board that need to be filled in with system tiles\n     */\n    getNewTilesToPlace() {\n        // Copy all the tile arrays from board data\n        let primary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"primary_tiles\"]];\n        let secondary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"secondary_tiles\"]];\n        let tertiary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"tertiary_tiles\"]];\n\n        // If shuffling, we need to shuffle primary, secondary, and tertiary indexes.\n        if (this.state.shuffleBoards) {\n            this.shuffle(primary);\n            this.shuffle(secondary);\n            this.shuffle(tertiary);\n        }\n\n        // Based on the placement style, generate the list of indexes to place\n        let systemIndexes = [];\n        switch(this.state.currentPlacementStyle) {\n            case(\"random\"):\n                // Add them all together and shuffle them\n                if (this.state.reversePlacementOrder) {\n                    systemIndexes = tertiary.concat(secondary).concat(primary);\n                } else {\n                    systemIndexes = primary.concat(secondary).concat(tertiary);\n                }\n                this.shuffle(systemIndexes);\n                break;\n            case(\"initial\"):\n                // Primary tiles are separate from the secondary shuffled tiles\n                if (this.state.reversePlacementOrder) {\n                    systemIndexes = this.shuffle(secondary.concat(tertiary)).concat(primary);\n                } else {\n                    systemIndexes = primary.concat(this.shuffle(secondary.concat(tertiary)));\n                }\n                break;\n            case(\"home\"):\n                // Primary tiles are tiles adjacent to home systems\n                systemIndexes = primary.concat(secondary).concat(tertiary);\n\n                // Get home systems\n                let home = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"home_worlds\"]];\n                let newPrimary = [];\n                for (let homeSystem of home) {\n                    // Loop over adjacent systems\n                    let adjacentSystems = adjacencyData[homeSystem];\n                    for (let adjacentSystem of adjacentSystems) {\n                        // Remove the adjacent system from the complete list (if it exists), and add it to the front\n                        if (systemIndexes.indexOf(adjacentSystem) >= 0) {\n                            newPrimary.push(adjacentSystem);\n                            systemIndexes.splice(systemIndexes.indexOf(adjacentSystem), 1);\n                        }\n                    }\n                }\n\n                // Add the adjacent planets to the front of the list\n                this.shuffle(newPrimary);\n                if (this.state.reversePlacementOrder) {\n                    systemIndexes = systemIndexes.concat(newPrimary);\n                } else {\n                    systemIndexes = newPrimary.concat(systemIndexes);\n                }\n                break;\n            case(\"slice\"):\n            default:\n                // Combine them in their listed order\n                if (this.state.reversePlacementOrder) {\n                    systemIndexes = tertiary.concat(secondary).concat(primary);\n                } else {\n                    systemIndexes = primary.concat(secondary).concat(tertiary);\n                }\n                break;\n        }\n\n        return systemIndexes;\n    }\n\n    /**\n     *\n     * Get an array of system tile numbers to place on the board.\n     * @param {number} numberOfSystems The number of systems to get.\n     * @param {boolean} useProphecyOfKings TODO\n     * @returns {[]}\n     */\n    getNewSystemsToPlace(numberOfSystems, useProphecyOfKings, currentRaces) {\n        // Pick our a random set of systems, following the needed number of anomalies\n        let allBlues = useProphecyOfKings ? [...tileData.blue.concat(tileData.pokBlue)] : [...tileData.blue];\n        let allReds = useProphecyOfKings ? [...tileData.red.concat(tileData.pokRed)] : [...tileData.red];\n\n        // Remove excluded tiles\n        for (let system of this.props.excludedTiles) {\n            if (allReds.indexOf(system) >= 0) {\n                allReds.splice(allReds.indexOf(system), 1);\n            } else if (allBlues.indexOf(system) >= 0) {\n                allBlues.splice(allBlues.indexOf(system), 1);\n            }\n        }\n\n        // Shuffle our tiles for randomness\n        this.shuffle(allBlues)\n        this.shuffle(allReds)\n\n        // Calculate how many reds we need based on player count\n        let blueTileRatio = 2;\n        let redTileRatio = 1;\n\n        //If the board style overrides blue and red ratios we use those values, otherwise we go to the switch statement\n        const currentBoardStyle = boardData.styles[this.state.currentNumberOfPlayers][this.state.currentBoardStyle];\n        if(currentBoardStyle['overrideRatios'] !== undefined) {\n            blueTileRatio = currentBoardStyle['overrideRatios']['blueTileRatio'];\n            redTileRatio = currentBoardStyle['overrideRatios']['redTileRatio'];\n        } else {\n            // For 3, 4, and 6 player games, there is a different ratio\n            switch (this.state.currentNumberOfPlayers) {\n                case(3):\n                    blueTileRatio = 3\n                    redTileRatio = 1\n                    break;\n                case(4):\n                    blueTileRatio = 5\n                    redTileRatio = 3\n                    break;\n                case(6):\n                    blueTileRatio = 3\n                    redTileRatio = 2\n                    break;\n                default:\n                    break;\n            }\n        }\n\n        let redsToPlace = Math.round(Number((numberOfSystems / (blueTileRatio + redTileRatio)) * redTileRatio));\n        let bluesToPlace = Math.round(Number((numberOfSystems / (blueTileRatio + redTileRatio)) * blueTileRatio));\n\n        // If planet heavy system, then reduce number of anomalies\n        // if (false) {\n        //     let newRedsToPlace = 2; // TODO make this user configurable\n        //     if (newRedsToPlace > redsToPlace) {\n        //         bluesToPlace = bluesToPlace - (newRedsToPlace - redsToPlace);\n        //     } else if (newRedsToPlace < redsToPlace) {\n        //         bluesToPlace = bluesToPlace + (redsToPlace - newRedsToPlace);\n        //     }\n        //     redsToPlace = newRedsToPlace\n        // }\n\n        // Start to get the new systems\n        let newSystems = [];\n\n        // Force add in the included tiles\n        for (let system of this.props.includedTiles) {\n            if (newSystems.indexOf(system) < 0) {\n                newSystems.push(system);\n\n                // Remove them from the pool to add\n                if (allReds.indexOf(system) >= 0) {\n                    allReds.splice(allReds.indexOf(system), 1);\n                    redsToPlace -= 1;\n                } else {\n                    allBlues.splice(allBlues.indexOf(system), 1);\n                    bluesToPlace -= 1;\n                }\n            }\n        }\n\n        // Force add in the locked tiles\n        for (let system of this.props.lockedTiles) {\n            if (newSystems.indexOf(system) < 0) {\n                newSystems.push(system);\n\n                // Remove them from the pool to add\n                if (allReds.indexOf(system) >= 0) {\n                    allReds.splice(allReds.indexOf(system), 1);\n                    redsToPlace -= 1;\n                } else {\n                    allBlues.splice(allBlues.indexOf(system), 1);\n                    bluesToPlace -= 1;\n                }\n            }\n        }\n\n        // These tiles are ensured for races and may not be replaced\n        const ensuredAnomalies = [];\n\n        if(this.state.ensureRacialAnomalies && this.state.pickRaces) {\n            currentRaces.forEach(race => {\n                let anomalies = []\n                let match = false;\n                // If The Clan of Saar are in the game, ensure we have an asteroid field\n                if(race === 'The Clan of Saar') {\n                    anomalies = useProphecyOfKings ? [...tileData.asteroidFields.concat(tileData.pokAsteroidFields)] : [...tileData.asteroidFields];\n                    match = true;\n                // If The Embers of Muaat are in the game, ensure we have a supernova\n                } else if(race === 'The Embers of Muaat') {\n                    anomalies = useProphecyOfKings ? [...tileData.supernovas.concat(tileData.pokSupernovas)] : [...tileData.supernovas];\n                    match = true;\n                // If The Empyrean are in the game, ensure we have a nebulae\n                } else if(race === 'The Empyrean') {\n                    anomalies = useProphecyOfKings ? [...tileData.nebulae.concat(tileData.pokNebulae)] : [...tileData.nebulae];\n                    match = true;\n                // If The Vuil'Raith Cabal are in the game, ensure we have a gravity rift\n                } else if(race === \"The Vuil'Raith Cabal\") {\n                    anomalies = useProphecyOfKings ? [...tileData.gravityRifts.concat(tileData.pokGravityRifts)] : [...tileData.gravityRifts];\n                    match = true;\n                }\n                if(match && redsToPlace > 0) {\n                    // Check if the tile is already included\n                    const found = anomalies.some(tile=> newSystems.includes(tile));\n                    // If not we add it\n                    if(!found) {\n                        this.shuffle(anomalies);\n                        newSystems.push(anomalies[0]);\n                        ensuredAnomalies.push(anomalies[0]);\n                        allReds.splice(allReds.indexOf(anomalies[0]), 1);\n                        redsToPlace -= 1;\n                    } else {\n                        ensuredAnomalies.push(newSystems.find(system => anomalies.includes(system)));\n                    }\n                }\n            });\n        }\n\n        // Place as many as possible from tile type if there is not enough to place\n        if (redsToPlace > allReds.length) {\n            newSystems = newSystems.concat(allBlues.slice(0, bluesToPlace + (redsToPlace - allReds.length)).concat(allReds))\n        } else if (bluesToPlace > allBlues.length) {\n            newSystems = newSystems.concat(allBlues.concat(allReds.slice(0, redsToPlace + (bluesToPlace - allBlues.length))))\n        } else {\n            newSystems = newSystems.concat(allBlues.slice(0, bluesToPlace).concat(allReds.slice(0, redsToPlace)))\n        }\n\n        // Ensure that if a wormhole is included, two are\n        const allAlphaWormholes = useProphecyOfKings ? [...tileData.alphaWormholes.concat(tileData.pokAlphaWormholes)] : [...tileData.alphaWormholes];\n        const allBetaWormholes = useProphecyOfKings ? [...tileData.betaWormholes.concat(tileData.pokBetaWormholes)] : [...tileData.betaWormholes];\n\n        newSystems = this.ensureWormholesForType(newSystems, [26], allAlphaWormholes, allBetaWormholes, useProphecyOfKings, ensuredAnomalies);\n\n        // Ensure that if we have an alpha wormhole, then we have at least two of them\n        newSystems = this.ensureWormholesForType(newSystems, [25, 64], allBetaWormholes, allAlphaWormholes, useProphecyOfKings, ensuredAnomalies);\n\n        // Based on the system style, order the systems according to their weights\n        let weights = {};\n        switch (this.state.currentPickStyle) {\n            case \"random\":\n                this.shuffle(newSystems)\n                return newSystems\n            case \"custom\":\n                weights = {\n                    \"resource\": parseInt(this.state.resourceWeight),\n                    \"influence\": parseInt(this.state.influenceWeight),\n                    \"planet_count\": parseInt(this.state.planetCountWeight),\n                    \"specialty\": parseInt(this.state.specialtyWeight),\n                    \"anomaly\": parseInt(this.state.anomalyWeight),\n                    \"wormhole\": parseInt(this.state.wormholeWeight),\n                    \"racial\": parseInt(this.state.wormholeWeight) - 5\n                }\n                break;\n            case \"resource\":\n                weights = {\n                    \"resource\": 100,\n                    \"influence\": 10,\n                    \"planet_count\": 10,\n                    \"specialty\": 10,\n                    \"anomaly\": 10,\n                    \"wormhole\": 10,\n                    \"racial\": 5\n                }\n                break;\n            case \"influence\":\n                weights = {\n                    \"resource\": 10,\n                    \"influence\": 100,\n                    \"planet_count\": 10,\n                    \"specialty\": 10,\n                    \"anomaly\": 10,\n                    \"wormhole\": 10,\n                    \"racial\": 5\n                }\n                break;\n            case \"balanced\":\n            default:\n                if (useProphecyOfKings) {\n                    weights = {\n                        \"resource\": 80,\n                        \"influence\": 30,\n                        \"planet_count\": 15,\n                        \"specialty\": 50,\n                        \"anomaly\": 40,\n                        \"wormhole\": 25,\n                        \"racial\": 20\n                    }\n                } else {\n                    weights = {\n                        \"resource\": 80,\n                        \"influence\": 30,\n                        \"planet_count\": 15,\n                        \"specialty\": 40,\n                        \"anomaly\": 30,\n                        \"wormhole\": 25,\n                        \"racial\": 20\n                    }\n                }\n                break;\n        }\n\n        // Re-order the planets based on their weights\n        newSystems = this.getWeightedPlanetList(newSystems, weights, ensuredAnomalies)\n\n        return newSystems\n\n    }\n    placeHyperlanes(newTiles) {\n        // Place hyperlanes in their specific layout and orientation\n        // TODO in the future, can this be random? Can they rotate?\n        for (let index = 0; index < boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['hyperlane_tiles'].length; index++) {\n            let hyperlaneData = boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['hyperlane_tiles'][index]\n            newTiles[hyperlaneData[0]] = hyperlaneData[1] + \"-\" + hyperlaneData[2]\n        }\n    }\n    placeHomeSystems(newTiles, currentRaces) {\n        // Place data for the homeSystems from board data\n        for (let index = 0; index < boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['home_worlds'].length; index++) {\n            let planetIndex = boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['home_worlds'][index]\n            if (this.state.pickRaces && !this.state.pickMultipleRaces) {\n                // Convert races into race hexes and assign a random race to a player\n                newTiles[planetIndex] = raceData.raceToHomeSystemMap[currentRaces[0]]\n                currentRaces.shift();\n            } else {\n                // Set home worlds to 0, races to be decided later\n                newTiles[planetIndex] = 0\n            }\n        }\n    }\n    placeLockedSystems(newTiles) {\n        for (let system of this.props.lockedTiles) {\n            // Get location in current tile set\n            let currentLocation = this.props.tiles.indexOf(system);\n            if (currentLocation >= 0) {\n                // It exists, so get its location on the current board\n                let newTilesLocation = newTiles.indexOf(system);\n\n                // Swap the two tiles\n                newTiles[newTilesLocation] = newTiles[currentLocation];\n                newTiles[currentLocation] = system;\n            }\n        }\n    }\n    checkAdjacencies(newTiles, useProphecyOfKings) {// Planets have been placed, time to do post processing checks to make sure things are good to go.\n        // Get all anomalies that are adjacent to one another\n        let allTrueAnomalies = useProphecyOfKings ? [...tileData.anomaly.concat(tileData.pokAnomaly)] : [...tileData.anomaly];\n\n        for (let anomaly of allTrueAnomalies) {\n            // Ignore any anomalies in the locked or include list\n            if (this.props.includedTiles.indexOf(anomaly) < 0 && this.props.lockedTiles.indexOf(anomaly) < 0) {\n\n                let anomalyTileNumber = newTiles.indexOf(anomaly);\n                if (anomalyTileNumber >= 0) {\n                    // anomaly exists in the map, so check it\n                    let adjacentTiles = adjacencyData[anomalyTileNumber];\n                    let adjacentAnomalies = [];\n\n                    // Get a list of all adjacent anomalies to this one\n                    for (let adjacentTileNumber of adjacentTiles) {\n                        let adjacentTile = newTiles[adjacentTileNumber];\n                        if (allTrueAnomalies.indexOf(adjacentTile) >= 0) {\n                            // This tile is an anomaly\n                            adjacentAnomalies.push(adjacentTile)\n                        }\n                    }\n\n                    // If tile is in conflict more than 1 anomaly, see if there is a \"blank\" anomaly off the board to swap with. if not, then continue\n                    let swapped = false;\n                    let blankReds = useProphecyOfKings ? [...tileData.blankRed.concat(tileData.pokBlankRed)] : [...tileData.blankRed];\n                    if (adjacentAnomalies.length > 1) {\n                        let possibleBlanks = [];\n                        for (let blankRed of blankReds) {\n                            if (newTiles.indexOf(blankRed) < 0) {\n                                possibleBlanks.push(blankRed)\n                            }\n                        }\n                        possibleBlanks = this.shuffle(possibleBlanks);\n                        if (possibleBlanks.length > 0) {\n                            swapped = true;\n                            newTiles[anomalyTileNumber] = possibleBlanks[0];\n                        }\n                    }\n\n                    if (!swapped && adjacentAnomalies.length > 0) {\n                        // Look at all red back tiles on the board that are not anomalies, and see if they have adjacent anomalies\n                        for (let blankRed of blankReds) {\n                            let blankRedTileNumber = newTiles.indexOf(blankRed)\n                            if (blankRedTileNumber >= 0) {\n                                let adjacentTiles = adjacencyData[blankRedTileNumber];\n                                let swappable = true;\n                                for (let adjacentTile of adjacentTiles) {\n                                    if (allTrueAnomalies.indexOf(newTiles[adjacentTile]) >= 0 && adjacentTile !== anomalyTileNumber) {\n                                        // This blank has an adjacent anomaly, so throw it out\n                                        swappable = false;\n                                        break;\n                                    }\n                                }\n                                if (swappable) {\n                                    // This blank red has no other adjacent anomalies, so swap\n                                    newTiles[anomalyTileNumber] = blankRed;\n                                    newTiles[blankRedTileNumber] = anomaly;\n                                    swapped = true;\n                                    break;\n                                }\n                            }\n                        }\n                        if (!swapped) {\n                            let blankReds = useProphecyOfKings ? [...tileData.blankRed.concat(tileData.pokBlankRed)] : [...tileData.blankRed];\n                            let possibleBlanks = [];\n                            for (let blankRed of blankReds) {\n                                if (newTiles.indexOf(blankRed) < 0) {\n                                    possibleBlanks.push(blankRed)\n                                }\n                            }\n                            possibleBlanks = this.shuffle(possibleBlanks);\n                            if (possibleBlanks.length > 0) {\n                                swapped = true;\n                                newTiles[anomalyTileNumber] = possibleBlanks[0];\n                            }\n                            if (!swapped) {\n                                console.log(\"Error! Unable to swap anomaly to a free position.\")\n                            }\n                            /*\n                            There is a potential use for this strategy, but for now it seems pretty safe to just let it fail\n                            to swap on a blank. It is rare that it is impossible, and even when it is, its a pretty simple\n                            rule. Plus the rules let you place reds next to each other if moving them is impossible.\n                            btw, not sure this code below works properly. I believe there is a bug in it.\n                             */\n\n                            /*\n                            // Going in reverse, find the first tile with no anomalies adjacent, and swap\n                            newTiles.reverse()\n                            for (let tile of newTiles) {\n                                if (tile !== 0 && tile !== -1 && allTrueAnomalies.indexOf(tile) < 0 && blankReds.indexOf(tile) < 0) {\n                                    console.log(\"Tile: \" + tile)\n                                    // This is a real tile, check for adjacency to other anomalies\n                                    let blankRedTileNumber = newTiles.indexOf(tile)\n                                    let adjacentTiles = adjacencyData[blankRedTileNumber];\n                                    let swappable = true;\n                                    for (let adjacentTile of adjacentTiles) {\n                                        if (allTrueAnomalies.indexOf(newTiles[adjacentTile]) >= 0) {\n                                            // This blank has an adjacent anomaly, so throw it out\n                                            swappable = false;\n                                            break;\n                                        }\n                                    }\n                                    if (swappable) {\n                                        // No adjacency breaks found, go ahead and swap it\n                                        console.log(anomalyTileNumber)\n                                        console.log(blankRedTileNumber)\n                                        newTiles[anomalyTileNumber] = tile;\n                                        newTiles[blankRedTileNumber] = anomaly;\n                                        swapped = true;\n                                        break;\n                                    }\n                                }\n                            }\n                            // If no swap possible, no problem. Continue on\n                            newTiles.reverse()\n                            */\n                        }\n                    }\n                }\n            }\n        }\n\n        const allAlphaWormholes = useProphecyOfKings ? [...tileData.alphaWormholes.concat(tileData.pokAlphaWormholes)] : [...tileData.alphaWormholes];\n        const allBetaWormholes = useProphecyOfKings ? [...tileData.betaWormholes.concat(tileData.pokBetaWormholes)] : [...tileData.betaWormholes];\n\n\n        // Alpha, at least one wormhole is a \"empty tile\" so swap it with a blank tile\n        for (let alphaWormhole of allAlphaWormholes) {\n            let alphaWormholeTileNumber = newTiles.indexOf(alphaWormhole);\n            if (alphaWormholeTileNumber >= 0 && tileData.all[alphaWormhole].planets.length === 0) {\n                // Wormhole exists on the board, and is blank. Check if it is adjacent to another wormhole\n                let adjacentTileNumbers = adjacencyData[alphaWormholeTileNumber];\n                let adjacentWormhole = false;\n                for (let adjacentTileNumber of adjacentTileNumbers) {\n                    if (allAlphaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0) {\n                        adjacentWormhole = true;\n                        break;\n                    }\n                }\n                if (adjacentWormhole) {\n                    // This blank has an adjacent wormhole, so we need to move it. Loop over all blanks to swap with\n                    let blankReds = useProphecyOfKings ? [...tileData.blankRed.concat(tileData.pokBlankRed)] : [...tileData.blankRed];\n                    // Remove wormholes from blank reds, because swapping alphas doesn't make sense.\n                    blankReds = blankReds.filter( function( el ) {\n                        return allAlphaWormholes.indexOf( el ) < 0;\n                    } );\n                    blankReds = this.shuffle(blankReds);\n                    for (let blankRed of blankReds) {\n                        let blankRedTileNumber = newTiles.indexOf(blankRed)\n                        if (blankRedTileNumber >= 0) {\n                            let adjacentTilesNumbers = adjacencyData[blankRedTileNumber];\n                            let swappable = true;\n                            for (let adjacentTileNumber of adjacentTilesNumbers) {\n                                if ((allAlphaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0 && adjacentTileNumber !== alphaWormholeTileNumber) || (allTrueAnomalies.indexOf(alphaWormhole) >= 0 && allTrueAnomalies.indexOf(newTiles[adjacentTileNumber]) >= 0)) {\n                                    // This blank has an adjacent anomaly, so throw it out\n                                    swappable = false;\n                                    break;\n                                }\n                            }\n                            if (swappable) {\n                                // This blank red has no other adjacent anomalies, so swap\n                                newTiles[alphaWormholeTileNumber] = blankRed;\n                                newTiles[blankRedTileNumber] = alphaWormhole;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        // Beta at least one planet wormhole, so swap it with another planet of equal resource value\n        for (let betaWormhole of allBetaWormholes) {\n            let betaWormholeTileNumber = newTiles.indexOf(betaWormhole);\n            if (betaWormholeTileNumber >= 0 && tileData.all[betaWormhole].planets.length === 0) {\n                // Wormhole exists on the board, and is blank. Check if it is adjacent to another wormhole\n                let adjacentTileNumbers = adjacencyData[betaWormholeTileNumber];\n                let adjacentWormhole = false;\n                for (let adjacentTileNumber of adjacentTileNumbers) {\n                    if (allBetaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0) {\n                        adjacentWormhole = true;\n                        break;\n                    }\n                }\n                if (adjacentWormhole) {\n                    // This blank has an adjacent wormhole, so we need to move it. Loop over all blanks to swap with\n                    let blankReds = useProphecyOfKings ? [...tileData.blue.concat(tileData.pokBlue)] : [...tileData.blue];\n                    // Remove wormholes from blank reds, because swapping alphas doesn't make sense.\n                    blankReds = blankReds.filter( function( el ) {\n                        return allBetaWormholes.indexOf( el ) < 0;\n                    } );\n                    blankReds = this.shuffle(blankReds);\n                    for (let blankRed of blankReds) {\n                        let blankRedTileNumber = newTiles.indexOf(blankRed)\n                        if (blankRedTileNumber >= 0) {\n                            let adjacentTilesNumbers = adjacencyData[blankRedTileNumber];\n                            let swappable = true;\n                            for (let adjacentTileNumber of adjacentTilesNumbers) {\n                                // Check for adjacency to another wormhole (excluding itself) and other anomalies\n                                if ((allBetaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0 && adjacentTileNumber !== betaWormholeTileNumber)) {\n                                    //\n                                    swappable = false;\n                                    break;\n                                }\n                            }\n                            if (swappable) {\n                                // This blank red has no other adjacent anomalies, so swap\n                                newTiles[betaWormholeTileNumber] = blankRed;\n                                newTiles[blankRedTileNumber] = betaWormhole;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    ensureWormholesForType(possibleTiles, planetWormholes, allWormholes, oppositeWormholes, useProphecyOfKings, ensuredAnomalies) {\n        let allAnomalyList = useProphecyOfKings ? [...tileData.red.concat(tileData.pokRed)] : [...tileData.red];\n        let unusedWormholes = [];\n        let usedWormholes = [];\n\n        // Get an array of all unused wormholes\n        for (let wormholeIndex in allWormholes) {\n            possibleTiles.indexOf(allWormholes[wormholeIndex]) < 0 ?\n                unusedWormholes.push(allWormholes[wormholeIndex]) : usedWormholes.push(allWormholes[wormholeIndex]);\n        }\n\n        // If there is only one wormhole, then we need to add a new one in\n        if (usedWormholes.length === 1) {\n            /*\n            Lets do some tricky logic here. If we are using a planet wormhole tile, then we want to replace\n            another anomaly with one of the other one (pok: two) anomaly wormholes. If we are not using the planet tile,\n            then we can try to find a planet to replace with any remaining wormhole tiles.\n             */\n            unusedWormholes = this.shuffle(unusedWormholes);\n            let excludedTiles = [...allWormholes.concat(oppositeWormholes)].concat(ensuredAnomalies);\n\n            // Check that the single used wormhole is not a planet.\n            if (planetWormholes.indexOf(usedWormholes[0]) < 0) {\n                // Try to replace some other planet with a planet wormhole\n                unusedWormholes = planetWormholes;\n                excludedTiles = excludedTiles.concat(allAnomalyList);\n            } else {\n                // Using a planet, so try to replace an anomaly with a wormhole\n                let wormholesToUse = []\n                for (let unusedWormhole of unusedWormholes) {\n                    if (planetWormholes.indexOf(unusedWormhole) < 0) {\n                        wormholesToUse.push(unusedWormhole)\n                    }\n                }\n                unusedWormholes = wormholesToUse\n            }\n            possibleTiles = this.reverseReplace(possibleTiles, 1, unusedWormholes, excludedTiles, false);\n        }\n\n        return possibleTiles;\n    }\n\n    ensureAnomalies(possibleTiles, numPlanetsToPlace, useProphecyOfKings) {\n        // Only care about the tiles we will actually place\n        possibleTiles = possibleTiles.slice(0, numPlanetsToPlace);\n\n        // Check that there is a minimum number of anomalies on the board\n        let blueTileRatio = 2;\n        let redTileRatio = 1;\n        // For 3, 4, and 6 player games, there is a different ratio\n        switch (this.state.currentNumberOfPlayers) {\n            case(3):\n                blueTileRatio = 3\n                redTileRatio = 1\n                break;\n            case(4):\n                blueTileRatio = 5\n                redTileRatio = 3\n                break;\n            case(6):\n                blueTileRatio = 3\n                redTileRatio = 2\n                break;\n            default:\n                break;\n        }\n        let numAnomaliesLeftToBePlaced = (numPlanetsToPlace / (blueTileRatio + redTileRatio)) * redTileRatio;\n\n        // If there is no anomalies to add, then we are done\n        if (numAnomaliesLeftToBePlaced < 0) {\n            return possibleTiles\n        }\n\n        // Still have to add a certain number of anomalies in. Get a list of possible anomalies we can add to the tile list\n        let allAnomalyList = useProphecyOfKings ? [...tileData.red.concat(tileData.pokRed)] : [...tileData.red];\n\n        // Remove all current anomalies in use from this list\n        let possibleAnomalies = []\n        for (let anomalyIndex in allAnomalyList) {\n            if (possibleTiles.indexOf(allAnomalyList[anomalyIndex]) < 0) {\n                // Not using this anomaly yet, so we can add it\n                possibleAnomalies.push(allAnomalyList[anomalyIndex])\n            } else {\n                // Anomaly is already being used\n                numAnomaliesLeftToBePlaced -= 1;\n            }\n        }\n\n        // Randomize, so anomalies we are using are not always the same\n        possibleAnomalies = this.shuffle(possibleAnomalies);\n\n        return this.reverseReplace(possibleTiles, numAnomaliesLeftToBePlaced, possibleAnomalies, allAnomalyList, false)\n\n    }\n\n    /**\n     * Replace tiles starting from the lowest weight (bottom of the list being defined by reversPlacementOrder)\n     * @param possibleTiles {Int8Array} The ordered list of tiles, cut to the needed size\n     * @param numTilesToReplace {Number} The number of tiles we need to try to replace from replacement into possible\n     * @param replacementTiles {Int8Array} An array of all the tiles we can pick from to put into possibleTiles\n     * @param excludedTiles {Int8Array} An array of tiles we do not want to replace in possible\n     * @param reverseBeforeAndAfter {Boolean} Whether we want to reverse the list before and after replacement\n     * @returns {Int8Array} An ordered list of tiles, with some tiles being replaced\n     */\n    reverseReplace (possibleTiles, numTilesToReplace, replacementTiles, excludedTiles, reverseBeforeAndAfter) {\n        // If we aren't placing in reverse order, we want to start changing the worst tiles (which are usually last)\n        if (reverseBeforeAndAfter) {\n            possibleTiles = possibleTiles.reverse()\n        }\n        let currentTileIndex = possibleTiles.length - 1;\n\n        // While there are anomalies to place and a place to put them...\n        while (numTilesToReplace > 0 && replacementTiles.length > 0 && currentTileIndex > 0) {\n            // Check the index to see that it is not an anomaly or a 0 or -1 or 18 or hyperlane\n            let tileOfInterest = possibleTiles[currentTileIndex]\n            if (excludedTiles.indexOf(tileOfInterest) < 0 && tileOfInterest !== -1  && tileOfInterest !== 18 && tileOfInterest !== 0 && typeof tileOfInterest !== \"string\") {\n                // It is a replaceable tile, so fill it from the new anomalies list\n                possibleTiles[currentTileIndex] = replacementTiles.shift()\n                numTilesToReplace -= 1;\n            }\n            currentTileIndex -= 1;\n        }\n\n        // Undo the reverse from before\n        if (reverseBeforeAndAfter) {\n            possibleTiles = possibleTiles.reverse()\n        }\n\n        return possibleTiles\n    }\n\n    // TODO rename from planet to tile\n    getWeightedPlanetList(possiblePlanets, weights, ensuredAnomalies) {\n        // Generate an array of tuples where the first element is the plant's tile number and the second is its weight\n        let planetWeights = [];\n        for (let planetTileNumber in possiblePlanets) {\n            planetWeights.push([possiblePlanets[planetTileNumber], this.getWeight(possiblePlanets[planetTileNumber], weights, ensuredAnomalies)])\n        }\n\n        // Sort the returned list by weight, with higher weighted planets being first\n        planetWeights.sort(function(a, b) {\n            return b[1] - a[1];\n        })\n\n        // Do a little post process shuffling for roughly similar planets\n        let currentIndex = 0;\n        let currentHighValue = planetWeights[0][1];\n        let currentSetToShuffle = [];\n        let postPossiblePlanets = [];\n        while (currentIndex < planetWeights.length) {\n            let planetWeight = planetWeights[currentIndex];\n            // Something in this array, lets see if we add to it\n            if (planetWeight[1] >= (currentHighValue - this.state.shuffleThreshold)) {\n                // Add this item to the array to shuffle\n                currentSetToShuffle.push(planetWeight);\n            } else {\n                // We are now outside our shuffle range. So shuffle what we have, and add it to the post\n                currentSetToShuffle = this.shuffle(currentSetToShuffle)\n                postPossiblePlanets = postPossiblePlanets.concat(currentSetToShuffle)\n                currentSetToShuffle = [planetWeight]\n                currentHighValue = planetWeight[1]\n            }\n\n            currentIndex += 1;\n        }\n        currentSetToShuffle = this.shuffle(currentSetToShuffle)\n        postPossiblePlanets = postPossiblePlanets.concat(currentSetToShuffle)\n\n\n        // Convert from tuple down to just the tile number\n        let orderedPlanets = [];\n        for (let weightedPlanet in postPossiblePlanets) {\n            orderedPlanets.push(postPossiblePlanets[weightedPlanet][0]);\n        }\n\n        return orderedPlanets\n    }\n\n    getWeight(planetTileNumber, weights, ensuredAnomalies) {\n        let total_weight = 0\n        let tile = tileData.all[planetTileNumber.toString()]\n\n        // Go over all the planets in this tile and add up their values\n        for (let planetIndex in tile['planets']) {\n            let planet = tile['planets'][planetIndex]\n            total_weight += (planet['resources'] / 4) * weights['resource']\n            total_weight += (planet['influence'] / 4) * weights['influence']\n            total_weight += (weights['planet_count'] / 2)\n            total_weight += planet['specialty'] ? weights['specialty'] : 0\n        }\n\n        // Handle anomalies\n        if (tile['type'] === 'red') {\n            total_weight += weights['anomaly'] + 40;\n            // Providing bonuses to these sections mean the other ones are never used\n            // if (tile['anomaly'] === null\n            //     || tile['anomaly'] === 'asteroid-field'\n            //     || tile['anomaly'] === 'gravity-rift') {\n            //     // Give an extra boost to these anomalies, as they are easier to cross than others\n            //     total_weight += 20;  // Change total back to 30 if using this\n            // }\n        }\n        total_weight += tile['wormhole'] ? weights['wormhole'] : 0\n        total_weight += ensuredAnomalies.indexOf(planetTileNumber) > -1 ? weights['racial'] : 0\n\n        return total_weight\n    }\n    togglePickRacesHelp(event) {\n        this.setState({\n            pickRacesHelp: !this.state.pickRacesHelp\n        })\n    }\n    toggleBoardStyleHelp(event) {\n        this.setState({\n            boardStyleHelp: !this.state.boardStyleHelp\n        })\n    }\n    togglePlacementStyleHelp(event) {\n        this.setState({\n            placementStyleHelp: !this.state.placementStyleHelp\n        })\n    }\n    togglePickStyleHelp(event) {\n        this.setState({\n            pickStyleHelp: !this.state.pickStyleHelp\n        })\n    }\n    toggleSetPlayerNamesHelp(event) {\n        this.setState({\n            setPlayerNamesHelp: !this.state.setPlayerNamesHelp\n        })\n    }\n    toggleSetRacesHelp(event) {\n        this.setState({\n            setRacesHelp: !this.state.setRacesHelp\n        })\n    }\n    togglePickMultipleRacesHelp(event) {\n        this.setState({\n            pickMultipleRacesHelp: !this.state.pickMultipleRacesHelp\n        })\n    }\n    toggleShufflePriorityHelp(event) {\n        this.setState({\n            shufflePriorityHelp: !this.state.shufflePriorityHelp\n        })\n    }\n    toggleReversePlacementOrderHelp(event) {\n        this.setState({\n            reversePlacementOrderHelp: !this.state.reversePlacementOrderHelp\n        })\n    }\n    toggleEnsureRacialAnomaliesHelp(event) {\n        this.setState({\n            ensureRacialAnomaliesHelp: !this.state.ensureRacialAnomaliesHelp\n        })\n    }\n\n    render() {\n        return (\n            <div id=\"options\" className={this.props.visible ? \"\" : \"d-none\"}>\n                <div className=\"title\">\n                    <h4 className=\"text-center\">Generation Options</h4>\n                </div>\n                <form id=\"generateForm\" onSubmit={this.generateBoard}>\n\n                    <div className=\"custom-control custom-checkbox mb-3\">\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"pokExpansion\" name=\"useProphecyOfKings\" checked={this.props.useProphecyOfKings} onChange={this.updatePok} />\n                        <label className=\"custom-control-label\" htmlFor=\"pokExpansion\">Use Prophecy of Kings Expansion</label>\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"playerCount\">Number of Players</label>\n                        <select className=\"form-control\" id=\"playerCount\" name=\"currentNumberOfPlayers\" value={this.state.currentNumberOfPlayers} onChange={this.updatePlayerCount}>\n                            {this.state.currentNumberOfPlayersOptions.map((x) => <option key={x} value={x}>{x}</option>)}\n                        </select>\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"boardStyle\" className=\"d-flex\">Board Style\n                            <QuestionCircle className=\"icon\" onClick={this.toggleBoardStyleHelp} />\n                        </label>\n                        <select className=\"form-control\" id=\"boardStyle\" name=\"currentBoardStyle\" value={this.state.currentBoardStyle} onChange={this.updateBoardStyle}>\n                            {this.state.currentBoardStyleOptions.map((x) => <option key={x} value={x}>{this.capitalize(x)}</option>)}\n                        </select>\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"placementStyle\" className=\"d-flex\">Placement Style\n                            <QuestionCircle className=\"icon\" onClick={this.togglePlacementStyleHelp} />\n                        </label>\n                        <select className=\"form-control\" id=\"placementStyle\" name=\"currentPlacementStyle\" value={this.state.currentPlacementStyle} onChange={this.handleInputChange}>\n                            {this.state.optionsPossible.placementStyles.map((x) => <option key={x} value={x}>{this.capitalize(x)}</option>)}\n                        </select>\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"pickStyle\" className=\"d-flex\">System Weighting\n                            <QuestionCircle className=\"icon\" onClick={this.togglePickStyleHelp} />\n                        </label>\n                        <select className=\"form-control\" id=\"pickStyle\" name=\"currentPickStyle\" value={this.state.currentPickStyle} onChange={this.handleInputChange}>\n                            {this.state.optionsPossible.pickStyles.map((x) => <option key={x} value={x}>{this.capitalize(x)}</option>)}\n                        </select>\n                    </div>\n\n                    <div className={\"ml-2 collapse \" + (this.state.currentPickStyle === \"custom\" ? \"show\" : \"\")} id=\"customPickStyle\">\n                        <div className=\"card card-body\">\n                            <label htmlFor=\"customResource\">Resource</label>\n                            <input type=\"range\" className=\"custom-range\" name=\"resourceWeight\" value={this.state.resourceWeight} onChange={this.handleInputChange} />\n\n                            <label htmlFor=\"customInfluence\">Influence</label>\n                            <input type=\"range\" className=\"custom-range\" name=\"influenceWeight\" value={this.state.influenceWeight} onChange={this.handleInputChange} />\n\n                            <label htmlFor=\"customPlanetCount\">Planet Count</label>\n                            <input type=\"range\" className=\"custom-range\" name=\"planetCountWeight\" value={this.state.planetCountWeight} onChange={this.handleInputChange} />\n\n                            <label htmlFor=\"customSpecialty\">Specialty</label>\n                            <input type=\"range\" className=\"custom-range\" name=\"specialtyWeight\" value={this.state.specialtyWeight} onChange={this.handleInputChange} />\n\n                            <label htmlFor=\"customAnomaly\">Anomaly</label>\n                            <input type=\"range\" className=\"custom-range\" name=\"anomalyWeight\" value={this.state.anomalyWeight} onChange={this.handleInputChange} />\n\n                            <label htmlFor=\"customWormhole\">Wormhole</label>\n                            <input type=\"range\" className=\"custom-range\" name=\"wormholeWeight\" value={this.state.wormholeWeight} onChange={this.handleInputChange} />\n                        </div>\n                    </div>\n\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"seed\">Specific Seed</label>\n                        <input className=\"form-control\" id=\"seed\" name=\"updateSeed\" type=\"text\" placeholder=\"Enter a number to seed generation...\" value={this.state.currentSeed} onChange={this.updateSeed} />\n                    </div>\n\n                    <div className=\"custom-control custom-checkbox mb-3 d-flex\">\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"pickRaces\" name=\"pickRaces\" checked={this.state.pickRaces} onChange={this.handleInputChange} />\n                        <label className=\"custom-control-label\" htmlFor=\"pickRaces\">Pick Races for Players</label>\n                        <QuestionCircle className=\"icon\" onClick={this.togglePickRacesHelp} />\n                    </div>\n                    <div className={\"ml-2 mb-2 collapse \" + (this.state.pickRaces ? \"show\" : \"\")} id=\"pickRacesCollapse\">\n                        <div className=\"card card-body\">\n                            <button type=\"button\" className=\"btn btn-outline-primary mb-2\" onClick={this.toggleSetRacesHelp}>Set Included Races</button>\n\n                            <button type=\"button\" className=\"btn btn-outline-primary mb-2\" onClick={this.toggleSetPlayerNamesHelp}>Set Player Names</button>\n                            \n                            <div className=\"custom-control custom-checkbox d-flex\">\n                                <input type=\"checkbox\" className=\"custom-control-input\" id=\"ensureRacialAnomalies\" name=\"ensureRacialAnomalies\" checked={this.state.ensureRacialAnomalies} onChange={this.handleInputChange} />\n                                <label className=\"custom-control-label\" htmlFor=\"ensureRacialAnomalies\">Ensure Racial Anomalies</label>\n                                <QuestionCircle className=\"icon\" onClick={this.toggleEnsureRacialAnomaliesHelp} />\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"custom-control custom-checkbox mb-3 d-flex\">\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"shuffleBoards\" name=\"shuffleBoards\" checked={this.state.shuffleBoards} onChange={this.handleInputChange} />\n                        <label className=\"custom-control-label\" htmlFor=\"shuffleBoards\">Randomize Priorities Before Placement</label>\n                        <QuestionCircle className=\"icon\" onClick={this.toggleShufflePriorityHelp} />\n                    </div>\n\n                    <div className=\"custom-control custom-checkbox mb-3 d-flex\">\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"reversePlacementOrder\" name=\"reversePlacementOrder\" checked={this.state.reversePlacementOrder} onChange={this.handleInputChange} />\n                        <label className=\"custom-control-label\" htmlFor=\"reversePlacementOrder\">Reverse Placement Order</label>\n                        <QuestionCircle className=\"icon\" onClick={this.toggleReversePlacementOrderHelp} />\n                    </div>\n\n                    <SetPlayerNameModal visible={this.state.setPlayerNamesHelp} currentPlayerNames={this.props.currentPlayerNames}\n                                        hideModal={this.toggleSetPlayerNamesHelp} handleNameChange={this.handleNameChange}\n                    />\n                    <SetRacesModal visible={this.state.setRacesHelp} races={this.state.optionsPossible.races}\n                                   pokRaces={this.state.optionsPossible.pokRaces} useProphecyOfKings={this.props.useProphecyOfKings}\n                                   currentRaces={this.props.currentRaces}\n                                   hideModal={this.toggleSetRacesHelp} handleRacesChange={this.handleRacesChange}\n                    />\n\n                    <HelpModal key={\"help-board\"} visible={this.state.boardStyleHelp} hideModal={this.toggleBoardStyleHelp} title={\"About Board Style\"}\n                         content='<p>\n                         Board style changes how the tiles are actually laid out on a newly generated map.\n                         <br>\n                         <br>\n                         Changing this would cause you to expect different hex layouts, such as different patterns of tiles, usage of hyperlanes, or unorthodox placement of home worlds.\n                         </p>'\n                    />\n                    <HelpModal key={\"help-placement\"} visible={this.state.placementStyleHelp} hideModal={this.togglePlacementStyleHelp} title={\"About Placement Style\"}\n                         content='<p>\n                         Placement style dictates where important tiles are placed. Most revolve around having at least one tile near the home system with good resources.\n                         <br>\n                         <br>\n                         <br><b>Slice:</b> Places tiles like a normal player would. Prioritizes a good pathway to mecatol, and filling in the area around the home system with good tiles.\n                         <br><b>Initial:</b> Only guarantees a good tile right in front of the home system (on the way to mecatol). Everything else is random.\n                         <br><b>Home:</b> Prioritizes all of the adjacent tiles to the home system and everything else is random.\n                         <br><b>Random:</b> Shuffles the priority levels completely. No favoritism to tiles near the home system.\n                         </p>'\n                    />\n                    <HelpModal key={\"help-pick\"} visible={this.state.pickStyleHelp} hideModal={this.togglePickStyleHelp} title={\"About Pick Style\"}\n                               content='<p>\n                         Pick Style is used to determine how tiles are weighted for when they are placed on the board. A higher weighted tile means that the hex is more important, and so (depending on the placement style) it is put closer to home worlds to facilitate available assets.\n                         <br>\n                         <br><b>Balanced:</b> A custom weight which favors resources and planet count more than anomalies. This more accurately factors in tech specialties and influence as trade-offs to the \"Resource\" pick.\n                         <br><b>Resource:</b> Tiles are ordered primarily by their resource values. Higher resource planets are more coveted, and so are more important.\n                         <br><b>Influence:</b> Similar to \"Resource\", tiles are ordered primarily by their influence values.\n                         <br><b>Random:</b> Tiles are completely randomly ordered. Expect chaotic and unbalanced maps.\n                         <br><b>Custom:</b> Enter your own values in for balancing tradeoffs between various tile qualities.\n                         </p>'\n\n                    />\n                    <HelpModal key={\"help-races\"} visible={this.state.pickRacesHelp} hideModal={this.togglePickRacesHelp} title={\"About Picking Races\"}\n                         content=\"<p>\n                         Automatically assigns races to the players on the boards.\n                         <br>\n                         <br>\n                         From the set of races, turning this on will assign every player a random race (designated by assigning them the homeworld tile of that race). You should pick which player sits at a certain position before turning this on.\n                         </p>\"\n                    />\n                    <HelpModal key={\"help-multiple\"} visible={this.state.pickMultipleRacesHelp} hideModal={this.togglePickMultipleRacesHelp} title={\"About Picking Multiple Races\"}\n                         content=\"<p>\n                         Divides all the races evenly up amongst the players in the game (with no overflow), so that they can choose from a selection instead of being specifically assigned one race.\n                         <br>\n                         <br>\n                         Some groups prefer to have a draft, where every player is given a few races to pick between. This lets them pick the races that they want to play, but not have any conflicts with other players about playing a certain race.\n                         </p>\"\n                    />\n                    <HelpModal key={\"help-priority\"} visible={this.state.shufflePriorityHelp} hideModal={this.toggleShufflePriorityHelp} title={\"About Shuffling Priority\"}\n                         content='<p>\n                         Randomizes the priority picks for each picking round.\n                         <br>\n                         <br>\n                         Normally when placing tiles, this tool attempts to place the tiles so player 1 does not always get the best tiles. To do this, it follows the game setup rules and (in a 6 player game) player 1 gets to place tile 1 and 12, while player 6 gets to place tile 6 and 7.\n                         <br>\n                         <br>\n                         Turning this on stops this from happening, and instead completely randomizes the placement order.\n                         </p>'\n                    />\n                    <HelpModal key={\"help-reverse\"} visible={this.state.reversePlacementOrderHelp} hideModal={this.toggleReversePlacementOrderHelp} title={\"About Reverse Placement Order\"}\n                         content='<p>\n                         Reverses which tiles are placed first in placement order.\n                         <br>\n                         <br>\n                         Tiles are normally placed in priority (see randomize priority help). This reverses the order, so that the last picks are first, which generally has the effect of pushing the more valuable tiles towards the center of the galaxy.\n                         </p>'\n                    />\n                    <HelpModal key={\"help-racial-anomalies\"} visible={this.state.ensureRacialAnomaliesHelp} hideModal={this.toggleEnsureRacialAnomaliesHelp} title={\"About Ensure Racial Anomalies\"}\n                         content=\"<p>\n                         Ensures that races get their beneficial anomalies\n                         <br>\n                         <br>\n                         This option makes it so that Muaat will always receive a supernova, Saar will always receive an asteroid field, Empyrean will always receive a nebulae and Vuil'Raith will always receive a gravity rift.\n                         </p>\"\n                    />\n            \n                    <button type=\"submit\" className=\"btn btn-primary\">Generate</button>\n                </form>\n            </div>\n        );\n    }\n}\nexport default MapOptions;","import React from 'react';\nimport $ from 'jquery';\nimport './App.css';\nimport BootstrapScripts from \"./helpers/BootstrapScripts\";\nimport MoreInfo from \"./panels/MoreInfo\";\nimport ExtraTiles from \"./panels/ExtraTiles\";\nimport MainOverview from \"./overview/MainOverview\";\nimport MainMap from \"./map/MainMap\";\nimport MapControls from \"./map/MapControls\";\nimport OptionsControls from \"./options/OptionsControls\";\nimport MapOptions from \"./options/MapOptions\";\nimport tileData from \"./data/tileData.json\";\nimport boardData from \"./data/boardData.json\";\nimport raceData from \"./data/raceData.json\";\nimport {calculateOffsets} from \"./helpers/Helpers\";\nimport ReactTooltip from \"react-tooltip\";\n\n\n/**\n * The core application page. Holds the states for common objects like tile data and player names. Responsible for\n * drawing the actual map.\n */\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        this.state = {\n            isOptionsMenuShowing: true,\n            overviewVisible: true,\n            extraTilesVisible: false,\n            moreInfoVisible: false,\n            backgroundAnimated: true,\n            showAllExtraTiles: false,\n            customMapBuilding: false,\n            tiles: [],\n            unusedTiles: [],\n            overlayVisible: false,\n            zoom: 1.0,\n            lastCall: 0,\n            mobileBreakpoint: 700,\n            isMobileView: false,\n            encodedOptions: \"\",\n\n            useProphecyOfKings: false,\n            currentPlayerNames: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n            currentRaces: [...raceData.races],\n\n            lockedTiles: [],\n            excludedTiles: [],\n            includedTiles: [],\n            tileClicked: -1,\n            currentMobileHover: \"\",\n        };\n\n        this.mapOptions = React.createRef();\n        this.map = React.createRef();\n\n        this.drawMap = this.drawMap.bind(this);\n\n        this.onPopState = this.onPopState.bind(this);\n        this.checkResize = this.checkResize.bind(this);\n\n        this.updateTiles = this.updateTiles.bind(this);\n        this.updateLockedTiles = this.updateLockedTiles.bind(this);\n        this.updateInExcludedTiles = this.updateInExcludedTiles.bind(this);\n        this.updateTileClicked = this.updateTileClicked.bind(this);\n        this.updateRaces = this.updateRaces.bind(this);\n        this.updatePlayerNames = this.updatePlayerNames.bind(this);\n        this.validateTiles = this.validateTiles.bind(this);\n        this.toggleBackground = this.toggleBackground.bind(this);\n        this.removeTrailing = this.removeTrailing.bind(this);\n        this.getTileNumber = this.getTileNumber.bind(this);\n\n        this.toggleOptionsMenu = this.toggleOptionsMenu.bind(this);\n        this.toggleProphecyOfKings = this.toggleProphecyOfKings.bind(this);\n        this.toggleOverlay = this.toggleOverlay.bind(this);\n        this.updateTileNumberOverlays = this.updateTileNumberOverlays.bind(this);\n        this.toggleMoreInfo = this.toggleMoreInfo.bind(this);\n        this.toggleExtraTiles = this.toggleExtraTiles.bind(this);\n        this.toggleShowAllExtraTiles = this.toggleShowAllExtraTiles.bind(this);\n        this.toggleCustomMapBuilding = this.toggleCustomMapBuilding.bind(this);\n        this.showExtraTiles = this.showExtraTiles.bind(this);\n        this.unsetAllTiles = this.unsetAllTiles.bind(this);\n        this.zoomScroll = this.zoomScroll.bind(this);\n        this.zoomPlusClick = this.zoomPlusClick.bind(this);\n        this.zoomMinusClick = this.zoomMinusClick.bind(this);\n        \n        this.drag = this.drag.bind(this);\n        this.drop = this.drop.bind(this);\n        this.dragEnter = this.dragEnter.bind(this);\n        this.dragLeave = this.dragLeave.bind(this);\n        this.allowDrop = this.allowDrop.bind(this);\n        this.handleDrop = this.handleDrop.bind(this);\n        this.handleTouchMove = this.handleTouchMove.bind(this);\n        this.handleTouchEnd = this.handleTouchEnd.bind(this);\n\n    }\n    \n    /* URL CONTROLS */\n\n    /**\n     * After all elements on the html page have been created, run this.\n     */\n    componentDidMount() {\n        // Setup the main jquery selectors\n        // TODO move these or find a way to not use them\n        this.$mapContainer =  $(\"#mainContent\");\n        this.$tiMap = $(\"#map\");\n\n        // Grab the variables from the url on back/forward events\n        window.onpopstate = this.onPopState\n        this.onPopState();\n\n        // Change the map dimensions whenever the page size is different\n        window.onresize = this.checkResize\n        this.checkResize();\n\n        // add when mounted\n        document.addEventListener(\"mousedown\", this.updateTileClicked);\n        document.addEventListener(\"wheel\", this.zoomScroll, true);\n    }\n\n    /**\n     * We are done with the page, removing everything.\n     */\n    componentWillUnmount() {\n        window.onpopstate = () => {};\n        document.removeEventListener(\"mousedown\", this.updateTileClicked);\n        document.removeEventListener(\"wheel\", this.zoomScroll);\n    }\n\n    /**\n     * When the window size is changed, update various components to be better looking on mobile vs desktop.\n     */\n    checkResize() {\n        if (window.innerWidth < this.state.mobileBreakpoint) {\n            if (!this.state.isMobileView) {\n                // Just transitioned into mobile state, so hide the options menu\n                this.setState({\n                    isMobileView: true,\n                    isOptionsMenuShowing: false,\n                })\n                document.documentElement.style.setProperty('--options-width', \"0px\");\n            } // else { // We went from mobile to mobile, don't need to do anything\n        } else {\n            // We are in desktop state\n            this.setState({\n                isMobileView: false,\n                isOptionsMenuShowing: true,\n            })\n            document.documentElement.style.setProperty('--options-width', \"400px\");\n        }\n\n        // Redraw with the new mobile conditions\n        this.drawMap()\n    }\n\n    /**\n     * Whenever we go back, grab the tiles from the url bar, and set them as the current tiles.\n     * @param {*} event The event that triggered this function.\n     */\n    onPopState(event) {\n        // Get the tiles from the url\n        let url = new URL(document.location);\n        let settings = url.searchParams.get(\"settings\");\n        let tiles = url.searchParams.get(\"tiles\");\n\n        // Make sure the tiles parameter is set to something\n        const newTiles = tiles !== null ? this.validateTiles(tiles) : [];\n        if (settings !== null && settings !== undefined && settings !== \"\") {\n            // Settings param is set, so make the tile\n            this.setState({\n                encodedOptions: settings,\n            }, () => {\n                this.mapOptions.current.decodeSettings(settings, newTiles);\n            })\n        } else if (newTiles.length > 0) {\n            this.setState({\n                tiles: newTiles\n            }, this.drawMap)\n        } else {\n            // No tiles or settings to worry about, just bring us back to the main page\n            this.setState({\n                tiles: []\n            }, this.drawMap)\n        }\n    };\n    \n    /* TILE CHANGING FUNCTIONS */\n\n    /**\n     * Updates the tiles state with a new set of tiles, and also pushes it to the url for sharable links\n     * @param {number[]} newTiles\n     * @param newEncodedOptions the settings, encoded as a string\n     * @param isNewGeneration A setting to be set when a new generation occurs, to trigger adding it to the history\n     * @param skipTrailing Don't remove trailing tiles\n     */\n    updateTiles(newTiles, newEncodedOptions, isNewGeneration, skipTrailing) {\n        // Remove the unused tile numbers at the end of the array\n        if (!skipTrailing) {\n            newTiles = this.removeTrailing(newTiles);\n        }\n\n        // Add it to the url as a parameter\n        let params = '&tiles=' + newTiles.toString()\n        let encodedOptions = this.state.encodedOptions;\n        if (newEncodedOptions !== undefined) {\n            if (this.state.lockedTiles.length > 0 || this.state.includedTiles.length > 0) {\n                params = \"?settings=\" + encodedOptions + params\n            } else {\n                params = \"?settings=\" + newEncodedOptions\n            }\n            encodedOptions = newEncodedOptions\n        } else {\n            params = \"?settings=\" + encodedOptions + params\n        }\n\n        if (isNewGeneration || newEncodedOptions === undefined) {\n            // This is a new generation, or we are moving tiles, so need to push the new state\n            window.history.pushState({}, null, window.location.pathname + params);\n        }\n\n        // Hide the options menu when we are on mobile (for when the tiles update and the options menu is open)\n        let newOptionsMenuState = this.state.isOptionsMenuShowing\n        if (this.state.isMobileView) {\n            newOptionsMenuState = false;\n        }\n\n        // Update the unused tiles list\n        let systemNumbers = []\n        systemNumbers = systemNumbers.concat(tileData.blue).concat(tileData.red);\n        if (this.state.useProphecyOfKings) {\n            systemNumbers = systemNumbers.concat(tileData.pokBlue).concat(tileData.pokRed);\n        }\n        let unusedTiles = []\n        for (let systemNumber of systemNumbers) {\n            // If it is not on the map, show the system tile. Otherwise, hide it.\n            if (!newTiles.includes(systemNumber)) {\n                unusedTiles.push(systemNumber)\n            }\n        }\n        let tileClicked = this.state.tileClicked;\n        if (isNewGeneration) {\n            tileClicked = -1\n        }\n\n        this.setState({\n            tiles: newTiles,\n            unusedTiles: unusedTiles,\n            tileClicked: tileClicked,\n            encodedOptions: encodedOptions,\n            isOptionsMenuShowing: newOptionsMenuState,\n        }, () => {\n            // Update the extra tiles menu, and draw a new map with the new tiles\n            this.showExtraTiles();\n            this.drawMap();\n        });\n    }\n\n    updateLockedTiles(newLockedTiles) {\n        this.setState({\n            lockedTiles: newLockedTiles,\n        })\n    }\n\n    updateTileClicked(newTileClicked) {\n        if (typeof newTileClicked !== \"number\" &&\n            (newTileClicked.target.id === \"mainContent\" || newTileClicked.target.id === \"map\")) {\n            this.setState({\n                tileClicked: -1,\n            })\n        } else if (typeof newTileClicked === \"number\") {\n            this.setState({\n                tileClicked: newTileClicked,\n            })\n        }\n    }\n\n    updateInExcludedTiles(newIncludedTiles, newExcludedTiles) {\n        this.setState({\n            includedTiles: newIncludedTiles,\n            excludedTiles: newExcludedTiles,\n        })\n    }\n\n    /**\n     * Removes any trailing -1s from a tile string.\n     * @param {number[]} tiles the tile string to clean\n     * @returns {number[]} the clean tile string\n     */\n    removeTrailing(tiles) {\n        while(tiles[tiles.length - 1] === -1){\n            tiles.pop();\n        }\n        return tiles;\n    }\n\n    /**\n     * Attempts to validate a given tile string, by cleaning it up and turning it into an object.\n     * @returns {number[]} An array of numbers representing tiles.\n     */\n    validateTiles(tiles) {\n        // Remove any spaces\n        tiles = tiles.replaceAll(\" \", \"\");\n        \n        // Check if it has opening and closing brackets. If so, remove them\n        if (tiles.charAt(0) === \"[\") {\n            tiles = tiles.substring(1, tiles.length);\n        }\n        if (tiles.charAt(tiles.length - 1) === \"]\") {\n            tiles = tiles.substring(0, tiles.length-1);\n        }\n        \n        // Now split on commas\n        tiles = tiles.split(',');\n        let newTiles = [];\n        for (let tile of tiles) {\n            newTiles.push(this.getTileNumber(tile, false, true));\n        }\n        return newTiles;\n    }\n    \n    /* BUTTON ACTIONS */\n\n    /**\n     * Toggle the visibility of the options menu for both desktop and mobile clients.\n     */\n    toggleOptionsMenu() {\n        // Set the css variable for options width (for desktop only)\n        if (window.innerWidth >= this.state.mobileBreakpoint) {\n            let optionsSize = this.state.isOptionsMenuShowing ? \"0px\" : \"400px\";\n            document.documentElement.style.setProperty('--options-width', optionsSize);\n        }\n        \n        // Update the map so that it correctly uses the new width\n        this.drawMap();\n        \n        // Update the state to the new view\n        this.setState({\n            isOptionsMenuShowing: !this.state.isOptionsMenuShowing,\n        });\n    }\n\n    /**\n     * Toggle the system number overlay.\n     */\n    toggleOverlay() {\n        this.updateTileNumberOverlays(!this.state.overlayVisible);\n        \n        this.setState({\n            overlayVisible: !this.state.overlayVisible,\n        });\n    }\n    \n    updateTileNumberOverlays(showTiles) {\n        // Toggle the tile overlays\n        for (let tileNumber = 0; tileNumber < boardData.pokSize; tileNumber++) {\n            let numOverlay = $(\"#number-\" + tileNumber);\n            if (showTiles) {\n                // Want to show all the tiles\n                if (this.getTileNumber(this.state.tiles[tileNumber]) !== -1 || this.state.customMapBuilding) {\n                    numOverlay.show();\n                } else {\n                    // Hide the -1s when not custom map building\n                    numOverlay.hide()\n                }\n            } else {\n                // Currently showing all tiles, so with toggle we will be hiding them\n                if (this.state.tiles[tileNumber] !== 0 || !this.state.moreInfoVisible) {\n                    numOverlay.hide()\n                }\n            }\n        }\n    }\n\n    toggleShowAllExtraTiles() {\n        this.setState({\n            showAllExtraTiles: !this.state.showAllExtraTiles,\n        }, this.showExtraTiles );\n    }\n\n    /**\n     * Set all tiles to -1, then redraw, effectively resetting the map.\n     */\n    unsetAllTiles() {\n        // Update the tile string\n        this.setState({\n            tileClicked: -1,\n        }, () => {\n            this.updateTiles(new Array(this.state.tiles.length).fill(-1), undefined, false, true);\n        } );\n    }\n\n    toggleCustomMapBuilding() {\n        this.setState({\n            customMapBuilding: !this.state.customMapBuilding,\n        }, () => {\n            this.updateTileNumberOverlays(this.state.customMapBuilding || this.state.overlayVisible);\n            this.showExtraTiles();\n            this.drawMap();\n        } );\n    }\n\n    /**\n     * Toggle whether we need to use the prophecy of kings expansion or not\n     */\n    toggleProphecyOfKings() {\n        this.setState({\n            useProphecyOfKings: !this.state.useProphecyOfKings,\n        }, this.showExtraTiles);\n    }\n\n    /**\n     * Toggle whether the more info side panel is visible. If the extra tiles panel had just been triggered, we just\n     * need to hide the more info panel.\n     * @param {*} event The event that triggered this function.\n     * @param {boolean} justTriggeredTiles Whether or not the extra tiles panel had just been opened.\n     */\n    toggleMoreInfo(event, justTriggeredTiles) {\n        // Guarantee that justTriggeredTiles is set\n        justTriggeredTiles = justTriggeredTiles === undefined ? false : justTriggeredTiles;\n\n        let optionsSize = this.state.moreInfoVisible ? \"0px\" : \"400px\";\n        document.documentElement.style.setProperty('--more-info-width', optionsSize);\n        \n        // Show the player names\n        for (let tileNumber = 0; tileNumber < boardData.pokSize; tileNumber++) {\n            if (this.state.tiles[tileNumber] === 0 && !this.state.overlayVisible) {\n                let numOverlay = $(\"#number-\" + tileNumber);\n                if (!this.state.moreInfoVisible) {\n                    // more info button pressed, so show overlay\n                    numOverlay.show()\n                } else {\n                    numOverlay.hide()\n                }\n            }\n        }\n\n        this.setState({\n            moreInfoVisible: !this.state.moreInfoVisible,\n        }, () => {\n            // Hide the extra tiles if the user just pressed the show more info button\n            if (this.state.extraTilesVisible && !justTriggeredTiles) {\n                this.toggleExtraTiles(event, true);\n            }\n        });\n    }\n\n    /**\n     * Toggle whether the extra tiles side panel is visible.\n     * @param {*} event The event that triggered this function.\n     * @param {boolean} justTriggeredInfo Whether or not the more info panel had just been opened.\n     */\n    toggleExtraTiles(event, justTriggeredInfo) {\n        justTriggeredInfo = justTriggeredInfo === undefined ? false : justTriggeredInfo;\n\n        // Update what tiles are going to be displayed\n        this.showExtraTiles();\n\n        let optionsSize = this.state.extraTilesVisible ? \"0px\" : \"250px\";\n        document.documentElement.style.setProperty('--extra-tiles-width', optionsSize);\n\n        this.setState({\n            extraTilesVisible: !this.state.extraTilesVisible,\n        }, () => {\n            if (this.state.moreInfoVisible && !justTriggeredInfo) {\n                this.toggleMoreInfo(event, true);\n            }\n        });\n    }\n\n    /**\n     * Update what tiles are visible in the extra tiles panel based on the current tiles being used on the map\n     */\n    showExtraTiles() {\n        let systemNumbers = []\n        systemNumbers = systemNumbers.concat(tileData.blue).concat(tileData.red);\n        if (this.state.useProphecyOfKings || this.state.showAllExtraTiles) {\n            systemNumbers = systemNumbers.concat(tileData.pokBlue).concat(tileData.pokRed);\n        }\n        if (this.state.customMapBuilding) {\n            systemNumbers = [-1].concat(systemNumbers.concat(tileData.hyperlanes));\n        }\n\n        for (let systemNumber of systemNumbers) {\n            // If it is not on the map, show the system tile. Otherwise, hide it.\n            let systemSelector = $(\"#extra-\" + systemNumber);\n            let overlaySelector = $(\"#extra-number-\" + systemNumber);\n\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\n                systemSelector.show();\n                overlaySelector.show();\n            } else {\n                if (!this.state.tiles.includes(systemNumber)) {\n                    systemSelector.show()\n                    overlaySelector.show();\n                } else {\n                    systemSelector.hide()\n                    overlaySelector.hide();\n                }\n            }\n        }\n    }\n\n\n    /**\n     * Toggle the background animation, from moving stars to static, and visa versa\n     */\n    toggleBackground() {\n        if (!this.state.backgroundAnimated) {\n            $(\"#stars\").css(\"animation\", \"animateStar 50s linear infinite\");\n            $(\"#stars2\").css(\"animation\", \"animateStar 100s linear infinite\");\n            $(\"#stars3\").css(\"animation\", \"animateStar 150s linear infinite\");\n        } else {\n            $(\"#stars\").css(\"animation\", \"staticStar 50s linear infinite\");\n            $(\"#stars2\").css(\"animation\", \"staticStar 100s linear infinite\");\n            $(\"#stars3\").css(\"animation\", \"staticStar 150s linear infinite\");\n        }\n        this.setState({\n            backgroundAnimated: !this.state.backgroundAnimated,\n        });\n    }\n\n    zoomScroll(event) {\n        if (this.state.lastCall < (Date.now() - 200) &&\n            event.ctrlKey &&\n            (event.target.id === \"mainContent\" || event.target.id === \"map\" || event.target.id.split(\"-\")[0] === \"tile\")) {\n            if (event.deltaY < 0) {\n                if (this.state.zoom < 3) {\n                    this.setState({\n                        zoom: this.state.zoom + 0.20,\n                        lastCall: Date.now()\n                    }, this.drawMap );\n                }\n            } else if (event.deltaY > 0) {\n                if (this.state.zoom > 0.5) {\n                    this.setState({\n                        zoom: this.state.zoom - 0.20,\n                        lastCall: Date.now()\n                    }, this.drawMap );\n                }\n            }\n        }\n    }\n\n    /**\n     * Zoom the map in by a set amount, up until it is the same size as the original images. Then redraw the map.\n     */\n    zoomPlusClick() {\n        if (this.state.zoom < 3) {\n            this.setState({\n                zoom: this.state.zoom + 0.75,\n            }, this.drawMap );\n        }\n    }\n\n    /**\n     * Zoom the map out by a set amount, up until it is too small to see. Then redraw the map.\n     */\n    zoomMinusClick() {\n        if (this.state.zoom > 0.5) {\n            this.setState({\n                zoom: this.state.zoom - 0.75,\n            }, this.drawMap );\n        }\n    }\n\n    updateRaces(races) {\n        this.setState({\n            currentRaces: races,\n        });\n    }\n\n    updatePlayerNames(playerNames) {\n        this.setState({\n            currentPlayerNames: playerNames,\n        });\n    }\n\n    /* MAP GENERATION */\n\n    getTileNumber(tile, numberOnly, withDash) {\n        if (tile !== undefined) {\n            let hyperlaneRegex = /^((8[3-9]|90|91)[AB])-?([0-5])?$/gm\n            let result = hyperlaneRegex.exec(tile);\n            if (result) {\n                if (numberOnly) {\n                    return Number(result[2]);\n                } else if (withDash) {\n                    return result[0];\n                } else {\n                    return result[1];\n                }\n            } else {\n                let regex = /^(80|81|82|-1|[0-7]?[0-9])-?([0-5])?$/gm\n                result = regex.exec(tile);\n                if (result) {\n                    return Number(result[1])\n                } else {\n                    return -1\n                }\n            }\n        } else {\n            return -1\n        }\n    }\n\n    /**\n     * The main rendering function for the map. Using the tile string, cleanly lays out a map that is centered in the\n     * map div.\n     */\n    drawMap() {\n        // Check to see if there are any tiles to render currently\n        if (this.state === undefined || this.state.tiles.length <= 0) {\n            this.setState({\n                overviewVisible: true,\n                mapVisible: false,\n                mapControlsVisible: false,\n            });\n            return;\n        } else {\n            this.setState({\n                overviewVisible: false,\n                mapVisible: true,\n                mapControlsVisible: true,\n            });\n        }\n\n        // Set the map height based on which tiles are being used\n        let mapNumberTilesHeight = 9;\n        let mapNumberTilesWidth = 7;\n        if (this.getTileNumber(this.state.tiles[37], true) >= 0 || this.getTileNumber(this.state.tiles[38], true) >= 0 || this.getTileNumber(this.state.tiles[60], true) >= 0\n            || this.getTileNumber(this.state.tiles[48], true) >= 0 || this.getTileNumber(this.state.tiles[49], true) >= 0 || this.getTileNumber(this.state.tiles[50], true) >= 0) {\n            mapNumberTilesHeight = 9;\n            mapNumberTilesWidth = 7;\n        } else if (this.getTileNumber(this.state.tiles[19], true) >= 0 || this.getTileNumber(this.state.tiles[20], true) >= 0 || this.getTileNumber(this.state.tiles[36], true) >= 0\n            || this.getTileNumber(this.state.tiles[27], true) >= 0 || this.getTileNumber(this.state.tiles[28], true) >= 0 || this.getTileNumber(this.state.tiles[29], true) >= 0) {\n            mapNumberTilesHeight = 7;\n            mapNumberTilesWidth = 5.5;\n        } else if (this.getTileNumber(this.state.tiles[7], true) >= 0 || this.getTileNumber(this.state.tiles[8], true) >= 0 || this.getTileNumber(this.state.tiles[18], true) >= 0\n            || this.getTileNumber(this.state.tiles[12], true) >= 0 || this.getTileNumber(this.state.tiles[13], true) >= 0 || this.getTileNumber(this.state.tiles[14], true) >= 0) {\n            mapNumberTilesHeight = 5;\n            mapNumberTilesWidth = 4;\n        } else if (this.getTileNumber(this.state.tiles[1], true) >= 0 || this.getTileNumber(this.state.tiles[2], true) >= 0 || this.getTileNumber(this.state.tiles[6], true) >= 0\n            || this.getTileNumber(this.state.tiles[3], true) >= 0 || this.getTileNumber(this.state.tiles[4], true) >= 0 || this.getTileNumber(this.state.tiles[5], true) >= 0) {\n            mapNumberTilesHeight = 3;\n            mapNumberTilesWidth = 2.5;\n        }\n\n        // Configuration options for magic numbers\n        let mapPadding = 0; // The amount of pad spacing to apply to the map edges\n        let mapTileWidth = 364; // The width of every tile in the static folder\n        let mapTileHeight = 317;\n\n        // Get extra information about the map\n        let mapWidth = this.$mapContainer.width() - (2 * mapPadding); // Put padding on top/bottom of map\n        let mapHeight = this.$mapContainer.height() - (2 * mapPadding); // Put padding on either side of map\n        let tileWidth = Math.floor(mapWidth / mapNumberTilesWidth)\n        let tileHeight = Math.floor(mapHeight / mapNumberTilesHeight)\n\n        // Determine which will be our constraining factor, width or height?\n        let constraintWidth = Math.min(this.state.zoom * Math.min(tileWidth, Math.floor((mapTileWidth / mapTileHeight) * tileHeight)), mapTileWidth) // Prohibit over-zooming\n        let constraintHeight = Math.floor((mapTileHeight / mapTileWidth) * constraintWidth)\n\n        // Configure the map container to be this size\n        this.$tiMap.css(\"width\", constraintWidth * mapNumberTilesWidth)\n            .css(\"height\", constraintHeight * mapNumberTilesHeight);\n\n        // Calculate the offset values for margin left and margin top per tile\n        let offsets = calculateOffsets(constraintWidth, constraintHeight)\n\n        // Loop over tiles to assign various values to them\n        let currentPlayerNumber = 0;\n        for (let tileNumber = 0; tileNumber < offsets.length; tileNumber++) {\n            // Create the selectors\n            let tile = $(\"#tile-\" + tileNumber);\n            let tileWrapper = $(\"#tile-wrapper-\" + tileNumber);\n            let numOverlay = $(\"#number-\" + tileNumber);\n            let underlay = $(\"#underlay-\" + tileNumber);\n            \n            // Decide if we should be displaying this tile\n            if (this.state.tiles[tileNumber] >= 0 || typeof this.state.tiles[tileNumber] === \"string\" || this.state.customMapBuilding) {\n                tile\n                    .css(\"left\", 0)\n                    .css(\"top\", 0)\n                    .css({'transform' : 'rotate(0)'})  // Reset any rotations from other hyperlanes\n                    .show();\n\n                tileWrapper\n                    .css(\"width\", constraintWidth)\n                    .css(\"height\", constraintHeight)\n                    .css(\"margin-left\", offsets[tileNumber][0])\n                    .css(\"margin-top\", offsets[tileNumber][1])\n                    .css(\"left\", (mapNumberTilesWidth / 2) * constraintWidth)\n                    .css(\"top\", (mapNumberTilesHeight / 2) * constraintHeight)\n                    .show()\n\n                if (typeof this.state.tiles[tileNumber] === \"string\") {\n                    // Hyperlane, so remove the last section and check if it needs to be rotated\n                    if (this.state.tiles[tileNumber].split(\"-\")[1] !== \"0\") {\n                        let degrees = 60 * Number(this.state.tiles[tileNumber].split(\"-\")[1]);\n                        tile.css({'transform' : 'rotate('+ degrees +'deg)'});\n                    }\n                }\n            } else {\n                tile.hide();\n            }\n\n            // Create the number overlay and the hover underlay for the tile\n            numOverlay\n                .css(\"margin-left\", \"-10px\")\n                .css(\"top\", constraintHeight/2 - 10)\n                .html(this.getTileNumber(this.state.tiles[tileNumber]))\n\n            underlay.css(\"width\", constraintWidth + 6)\n                .css(\"height\", constraintHeight + 6)\n                .css(\"margin-left\", \"-3px\")\n                .css(\"margin-top\", \"-3px\")\n    \n            // Set the names on the player home worlds to not be 0\n            if (this.state.tiles[tileNumber] === 0) {  // TODO should this override on selected races too?\n                // Show the player name\n                let name = this.state.currentPlayerNames[currentPlayerNumber];\n                numOverlay.html(name === \"\" ? \"P\" + (currentPlayerNumber + 1) : name);\n                currentPlayerNumber += 1;\n            }\n        }\n\n        // Clear any css classes on the map\n        this.$tiMap.removeClass(\"center-map\");\n        this.$tiMap.removeClass(\"center-map-vertical\");\n        this.$tiMap.removeClass(\"center-map-horizontal\");\n\n        // Check to see if we are zoomed, or map is always screen size.\n        if (this.state.zoom > 1.0) {\n            // Check to see if we should still be horizontally or vertically centered\n            if ((constraintWidth * mapNumberTilesWidth) < mapWidth) {\n                this.$tiMap.addClass(\"center-map-horizontal\");\n            } else if ((constraintHeight * mapNumberTilesHeight) < mapHeight) {\n                this.$tiMap.addClass(\"center-map-vertical\");\n            } else {\n                // Use default map values\n            }\n\n            // TODO find what the mouse is hovering nearest to, or over. Get that element, and zoom in. Something like\n            //  this? https://stackoverflow.com/questions/6519043/get-mouse-position-on-scroll\n\n            // Center Mecatol Rex on the screen\n            $(\"#tile-0\").get(0).scrollIntoView({behavior: \"smooth\", block:\"center\", inline: \"center\"});\n        } else {\n            // No need to move the map around, just center it on the screen\n            this.$tiMap.addClass(\"center-map\");\n        }\n    }\n\n    /* DRAG AND DROP FUNCTIONS, modified from https://www.w3schools.com/html/html5_draganddrop.asp */\n\n    allowDrop(ev) {\n        ev.preventDefault();\n    }\n    dragEnter(ev){\n        let targetSelector = $(\"#\" + ev.target.id);\n        let targetUnderlay = $(\"#underlay-\" + ev.target.id.split(\"-\")[1]);\n        targetSelector.addClass(\"tile-target\")\n        targetUnderlay.addClass(\"underlay-target\")\n    }\n    dragLeave(ev){\n        let targetSelector = $(\"#\" + ev.target.id);\n        let targetUnderlay = $(\"#underlay-\" + ev.target.id.split(\"-\")[1]);\n        targetSelector.removeClass(\"tile-target\")\n        targetUnderlay.removeClass(\"underlay-target\")\n    }\n    drag(ev) {\n        ev.dataTransfer.setData(\"text\", ev.target.id);\n    }\n    drop(ev) {\n        ev.preventDefault();\n        // Get the associated ids\n        let fromId = ev.dataTransfer.getData(\"text\");\n        let targetId = ev.target.id;\n\n        this.handleDrop(targetId, fromId)\n    }\n    handleDrop(targetId, fromId) {\n        // Create selectors\n        let targetSelector = $(\"#\" + targetId);\n        let fromSelector = $(\"#\" + fromId);\n        let targetUnderlay = $(\"#underlay-\" + targetId.split(\"-\")[1]);\n\n        // Get various variables for calculations\n        let targetType = targetId.split(\"-\")[0];\n        let fromType = fromId.split(\"-\")[0];\n        let targetSecond = targetId.slice(targetId.indexOf(\"-\") + 1);\n        let fromSecond = fromId.slice(fromId.indexOf(\"-\") + 1);\n\n        let tilesCopy = [...this.state.tiles];\n        let swapSources = true;\n\n        // Determine what swap is happening\n        if (fromType === \"tile\" && targetType === \"tile\") {\n            // Both are on the main map, so simply swap their positions in the tile array\n            let temp = tilesCopy[targetSecond];\n            tilesCopy[targetSecond] = tilesCopy[fromSecond];\n            tilesCopy[fromSecond] = temp;\n        } else if (fromType === \"extra\" && targetType === \"tile\") {\n            // Moving from the extra tiles onto the main map\n            let temp = tilesCopy[targetSecond];\n            tilesCopy[targetSecond] = this.getTileNumber(fromSecond);\n            // Update the id of the tile\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\n                swapSources = false;\n            } else {\n                fromSelector.attr('id', 'extra-' + temp)\n            }\n        } else if (fromType === \"tile\" && targetType === \"extra\") {\n            // Moving from the main map to the tiles\n            let temp = tilesCopy[fromSecond];\n            tilesCopy[fromSecond] = this.getTileNumber(targetSecond);\n            // Update the id of the tile\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\n                swapSources = false;\n            } else {\n                targetSelector.attr('id', 'extra-' + temp)\n            }\n        } else {\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\n                swapSources = false;\n            } else {\n                // Swapping extra tiles... Just update the ids\n                targetSelector.attr('id', 'extra-' + fromSecond)\n                fromSelector.attr('id', 'extra-' + targetSecond)\n            }\n        }\n\n        // Only swap sources if we need to\n        if (swapSources) {\n            // Temporarily store the target's source, and swap\n            let targetSource = targetSelector.attr('src');\n            targetSelector.attr('src', fromSelector.attr('src'));\n            fromSelector.attr('src', targetSource);\n        }\n\n        // Clear the target classes\n        targetSelector.removeClass(\"tile-target\");\n        targetUnderlay.removeClass(\"underlay-target\");\n    \n        // Check if we have empty tiles to fill in now. This can only happen with custom maps\n        if (this.state.customMapBuilding) {\n            tilesCopy = Array.from(tilesCopy, item => typeof item === 'undefined' ? -1 : item);\n        }\n\n        // Update the tile string\n        this.setState({\n            tileClicked: -1,\n        }, () => {\n            this.updateTiles(tilesCopy);\n        } );\n    }\n    handleTouchMove(event) {\n        let changedTouch = event.changedTouches[0];\n        let elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\n        if (elem.id !== undefined && elem.id !== \"\" && elem.id !== this.state.currentMobileHover) {\n            // At a transition stage\n            let targetSelector = $(\"#\" + elem.id);\n            let targetUnderlay = $(\"#underlay-\" + elem.id.split(\"-\")[1]);\n            targetSelector.addClass(\"tile-target\")\n            targetUnderlay.addClass(\"underlay-target\")\n\n            if (this.state.currentMobileHover !== \"\") {\n                let targetSelector = $(\"#\" + this.state.currentMobileHover);\n                let targetUnderlay = $(\"#underlay-\" + this.state.currentMobileHover.split(\"-\")[1]);\n                targetSelector.removeClass(\"tile-target\")\n                targetUnderlay.removeClass(\"underlay-target\")\n            }\n\n            this.setState({\n                currentMobileHover: elem.id,\n                tileClicked: -1,\n            });\n        }\n    }\n    handleTouchEnd(event) {\n        // event.preventDefault();\n        event.stopPropagation();\n        let changedTouch = event.changedTouches[0];\n        let elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\n        this.handleDrop(event.target.id, elem.id)\n\n        if (this.state.currentMobileHover !== \"\") {\n            let targetSelector = $(\"#\" + this.state.currentMobileHover);\n            let targetUnderlay = $(\"#underlay-\" + this.state.currentMobileHover.split(\"-\")[1]);\n            targetSelector.removeClass(\"tile-target\")\n            targetUnderlay.removeClass(\"underlay-target\")\n            this.setState({\n                currentMobileHover: \"\",\n                tileClicked: -1,\n            });\n        }\n    }\n    \n\n    render() {\n        return (\n            <div>\n                <div id=\"mainContent\" className=\"justify-content-center align-items-center\" onClick={this.updateTileClicked}>\n                    <MainOverview visible={this.state.overviewVisible}\n                    />\n                    \n                    <MainMap visible={this.state.mapVisible} overlayVisible={this.state.overlayVisible}\n                             tiles={this.state.tiles} useProphecyOfKings={this.state.useProphecyOfKings}\n\n                             ref={this.map}\n\n                             unusedTiles={this.state.unusedTiles} updateTiles={this.updateTiles}\n                             lockedTiles={this.state.lockedTiles} updateLockedTiles={this.updateLockedTiles}\n                             includedTiles={this.state.includedTiles} updateInExcludedTiles={this.updateInExcludedTiles}\n                             excludedTiles={this.state.excludedTiles}\n                             tileClicked={this.state.tileClicked} updateTileClicked={this.updateTileClicked}\n                             getTileNumber={this.getTileNumber}\n\n                             drag={this.drag} drop={this.drop} dragEnter={this.dragEnter} dragLeave={this.dragLeave}\n                             allowDrop={this.allowDrop} touchEnd={this.handleTouchEnd} touchMove={this.handleTouchMove}\n                    />\n                </div>\n\n                <OptionsControls visible={this.state.isOptionsMenuShowing} isMobileView={this.state.isMobileView}\n                                 toggleOptions={this.toggleOptionsMenu}\n                />\n\n                <MapControls visible={this.state.mapControlsVisible} extraTilesVisible={this.state.extraTilesVisible}\n                             moreInfoVisible={this.state.moreInfoVisible} overlayVisible={this.state.overlayVisible}\n                             tiles={this.state.tiles} map={this.map}\n\n                             toggleOverlay={this.toggleOverlay}\n                             toggleMoreInfo={this.toggleMoreInfo} toggleExtraTiles={this.toggleExtraTiles}\n                             zoomPlus={this.zoomPlusClick} zoomMinus={this.zoomMinusClick}\n                             toggleBackground={this.toggleBackground} updateTiles={this.updateTiles}\n                             removeTrailing={this.removeTrailing}\n                />\n                \n                <ExtraTiles visible={this.state.extraTilesVisible} overlayVisible={this.state.overlayVisible}\n                            useProphecyOfKings={this.state.useProphecyOfKings} showAllExtraTiles={this.state.showAllExtraTiles}\n                            customMapBuilding={this.state.customMapBuilding}\n\n                            updateTiles={this.updateTiles} toggleShowAllExtraTiles={this.toggleShowAllExtraTiles}\n                            toggleCustomMapBuilding={this.toggleCustomMapBuilding} unsetAllTiles={this.unsetAllTiles}\n\n                            drag={this.drag} drop={this.drop} dragEnter={this.dragEnter} dragLeave={this.dragLeave} allowDrop={this.allowDrop}\n                />\n                \n                <MoreInfo visible={this.state.moreInfoVisible} currentPlayerNames={this.state.currentPlayerNames}\n                          useProphecyOfKings={this.state.useProphecyOfKings} tiles={this.state.tiles}\n                          getTileNumber={this.getTileNumber}\n                />\n                \n                <MapOptions visible={this.state.isOptionsMenuShowing} useProphecyOfKings={this.state.useProphecyOfKings}\n                            currentPlayerNames={this.state.currentPlayerNames} currentRaces={this.state.currentRaces}\n                            tiles={this.state.tiles} includedTiles={this.state.includedTiles}\n                            excludedTiles={this.state.excludedTiles} lockedTiles={this.state.lockedTiles}\n\n                            ref={this.mapOptions}\n\n                            toggleProphecyOfKings={this.toggleProphecyOfKings} updateTiles={this.updateTiles}\n                            showExtraTiles={this.showExtraTiles} updateRaces={this.updateRaces}\n                            updatePlayerNames={this.updatePlayerNames}\n                />\n\n                <ReactTooltip effect={\"solid\"}/>\n                <BootstrapScripts />\n            </div>\n        );\n    }\n}\nexport default App;\n","/**\n * Calculate offsets of the tiles in relation to Mecatol Rex (the center tile). This information\n * is stored in an array of two value arrays. The two value arrays reperesent the margin left\n * and margin top to offset the tile (based on size of of tiles).\n * @param width The width (in pixels) of a single tile\n * @param height The height (in pixels) of a single tile\n * @returns {(number[]|(number)[])[]} an array of two value arrays.\n */\nexport const calculateOffsets = (width, height) => {\n    let leftWidth = -width\n    let topHeight = -height\n    let halfWidth = Math.ceil(leftWidth * 0.5)\n    let halfHeight = Math.ceil(topHeight * 0.5)\n    let treQuarWidth = Math.ceil(leftWidth * 0.75)\n\n    return [\n        [halfWidth, halfHeight],  // Mecatol Rex\n        // Inner ring\n        [halfWidth, halfHeight + topHeight],\n        [halfWidth - treQuarWidth, halfHeight + halfHeight],\n        [halfWidth - treQuarWidth, 0],\n        [halfWidth, halfHeight - topHeight],\n        [halfWidth + treQuarWidth, 0],\n        [halfWidth + treQuarWidth, halfHeight + halfHeight],\n        // Middle ring\n        [halfWidth, halfHeight + topHeight + topHeight],\n        [halfWidth - treQuarWidth, halfHeight + topHeight + halfHeight],\n        [halfWidth - leftWidth - halfWidth, halfHeight + topHeight],\n        [halfWidth - leftWidth - halfWidth, halfHeight],\n        [halfWidth - leftWidth - halfWidth, halfHeight - topHeight],\n        [halfWidth - treQuarWidth, halfHeight - topHeight - halfHeight],\n        [halfWidth, halfHeight - topHeight - topHeight],\n        [halfWidth + treQuarWidth, halfHeight - topHeight - halfHeight],\n        [halfWidth + leftWidth + halfWidth, halfHeight - topHeight],\n        [halfWidth + leftWidth + halfWidth, halfHeight],\n        [halfWidth + leftWidth + halfWidth, halfHeight + topHeight],\n        [halfWidth + treQuarWidth, halfHeight + topHeight + halfHeight],\n        // Outer Ring\n        [halfWidth, halfHeight + topHeight + topHeight + topHeight],\n        [halfWidth - treQuarWidth, halfHeight + topHeight + topHeight + halfHeight],\n        [halfWidth - leftWidth - halfWidth, halfHeight + topHeight + topHeight],\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight + topHeight + halfHeight],\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight + halfHeight],\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight - halfHeight],\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight - topHeight - halfHeight],\n        [halfWidth - leftWidth - halfWidth, halfHeight - topHeight - topHeight],\n        [halfWidth - treQuarWidth, halfHeight - topHeight - topHeight - halfHeight],\n        [halfWidth, halfHeight - topHeight - topHeight - topHeight],\n        [halfWidth + treQuarWidth, halfHeight - topHeight - topHeight - halfHeight],\n        [halfWidth + leftWidth + halfWidth, halfHeight - topHeight - topHeight],\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight - topHeight - halfHeight],\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight - halfHeight],\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight + halfHeight],\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight + topHeight + halfHeight],\n        [halfWidth + leftWidth + halfWidth, halfHeight + topHeight + topHeight],\n        [halfWidth + treQuarWidth, halfHeight + topHeight + topHeight + halfHeight],\n        // Extended Ring\n        [halfWidth, halfHeight + topHeight + topHeight + topHeight + topHeight],\n        [halfWidth - treQuarWidth, halfHeight + topHeight + topHeight + topHeight + halfHeight],\n        [halfWidth - leftWidth - halfWidth, halfHeight + topHeight + topHeight + topHeight],\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight + topHeight + topHeight + halfHeight],\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight + topHeight + topHeight],\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight + topHeight],\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight],\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight - topHeight],\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight - topHeight - topHeight],\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight - topHeight - topHeight - halfHeight],\n        [halfWidth - leftWidth - halfWidth, halfHeight - topHeight - topHeight - topHeight],\n        [halfWidth - treQuarWidth, halfHeight - topHeight - topHeight - topHeight - halfHeight],\n        [halfWidth, halfHeight - topHeight - topHeight - topHeight - topHeight],\n        [halfWidth + treQuarWidth, halfHeight - topHeight - topHeight - topHeight - halfHeight],\n        [halfWidth + leftWidth + halfWidth, halfHeight - topHeight - topHeight - topHeight],\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight - topHeight - topHeight - halfHeight],\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight - topHeight - topHeight],\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight - topHeight],\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight],\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight + topHeight],\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight + topHeight + topHeight],\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight + topHeight + topHeight + halfHeight],\n        [halfWidth + leftWidth + halfWidth, halfHeight + topHeight + topHeight + topHeight],\n        [halfWidth + treQuarWidth, halfHeight + topHeight + topHeight + topHeight + halfHeight],\n    ]\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}